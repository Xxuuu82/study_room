{"remainingRequest":"D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\src\\pages\\center\\center.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\src\\pages\\center\\center.vue","mtime":1765969153647},{"path":"D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgY29uZmlnIGZyb20gJ0AvY29uZmlnL2NvbmZpZycNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhKCkgew0KICAgIGNvbnN0IHZhbGlkYXRlTW9iaWxlID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gew0KICAgICAgaWYgKCF2YWx1ZSkgew0KICAgICAgICBjYWxsYmFjaygpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgY29uc3QgbW9iaWxlUmVnID0gL14xWzMtOV1cZHs5fSQvOw0KICAgICAgICBpZiAoIW1vYmlsZVJlZy50ZXN0KHZhbHVlKSkgew0KICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi6K+36L6T5YWl5q2j56Gu55qE5omL5py65Y+356CBIikpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIGNhbGxiYWNrKCk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9Ow0KDQogICAgY29uc3Qgdm0gPSB0aGlzOw0KDQogICAgcmV0dXJuIHsNCiAgICAgIHRpdGxlOiAn5Liq5Lq65Lit5b+DJywNCiAgICAgIGFjdGl2ZVRhYjogJ+S4quS6uuS/oeaBrycsDQogICAgICBiYXNlVXJsOiBjb25maWcuYmFzZVVybCwNCiAgICAgIHNlc3Npb25Gb3JtOiB7fSwNCiAgICAgIHB3ZEZvcm06IHsgb2xkUGFzc3dvcmQ6ICcnLCBuZXdQYXNzd29yZDogJycsIGNvbmZpcm1QYXNzd29yZDogJycgfSwNCiAgICAgIHJ1bGVzOiB7IHhpbmdtaW5nOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeWnk+WQjScsIHRyaWdnZXI6ICdibHVyJyB9XSwgc2hvdWppOiBbeyB2YWxpZGF0b3I6IHZhbGlkYXRlTW9iaWxlLCB0cmlnZ2VyOiAnYmx1cicgfV0gfSwNCiAgICAgIHB3ZFJ1bGVzOiB7DQogICAgICAgIG9sZFBhc3N3b3JkOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeWOn+WvhueggScsIHRyaWdnZXI6ICdibHVyJyB9XSwNCiAgICAgICAgbmV3UGFzc3dvcmQ6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5paw5a+G56CBJywgdHJpZ2dlcjogJ2JsdXInIH0sIHsgbWluOiA2LCBtZXNzYWdlOiAn5a+G56CB6ZW/5bqm5LiN6IO95bCR5LqONuS9jScsIHRyaWdnZXI6ICdibHVyJyB9XSwNCiAgICAgICAgY29uZmlybVBhc3N3b3JkOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+ehruiupOaWsOWvhueggScsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICAgIHsgdmFsaWRhdG9yOiBmdW5jdGlvbihydWxlLCB2YWx1ZSwgY2FsbGJhY2spIHsgaWYgKHZhbHVlICE9PSB2bS5wd2RGb3JtLm5ld1Bhc3N3b3JkKSBjYWxsYmFjayhuZXcgRXJyb3IoJ+S4pOasoeWvhueggeS4jeS4gOiHtCcpKTsgZWxzZSBjYWxsYmFjaygpOyB9LCB0cmlnZ2VyOiAnYmx1cicgfV0NCiAgICAgIH0sDQogICAgICB1cGxvYWRVcmw6IGNvbmZpZy5iYXNlVXJsICsgJ2ZpbGUvdXBsb2FkJywNCiAgICAgIGhlYWRlcnM6IHsgVG9rZW46IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdUb2tlbicpIH0sDQogICAgICB1c2VyVGFibGVOYW1lOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnVXNlclRhYmxlTmFtZScpLA0KICAgICAgc2VhcmNoRm9ybTogeyB5dXl1ZWRhbmhhbzogJycgfSwNCiAgICAgIGNhbmNlbE9yZGVyTGlzdDogW10sIGNhbmNlbE9yZGVyTG9hZGluZzogZmFsc2UsIHBhZ2VJbmRleDogMSwgcGFnZVNpemU6IDEwLCB0b3RhbFBhZ2U6IDAsDQogICAgICB1cGxvYWRpbmc6IGZhbHNlDQogICAgfQ0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuZ2V0U2Vzc2lvbigpOw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgdGFiU3R5bGUobmFtZSkgew0KICAgICAgcmV0dXJuIHsgd2lkdGg6ICIxMDAlIiwgYmFja2dyb3VuZDogdGhpcy5hY3RpdmVUYWIgPT09IG5hbWUgPyAiIzQwOUVGRiIgOiAiI2ZmZiIsIGNvbG9yOiB0aGlzLmFjdGl2ZVRhYiA9PT0gbmFtZSA/ICIjZmZmIiA6ICIjNDA5RUZGIiwgYm9yZGVyQ29sb3I6IHRoaXMuYWN0aXZlVGFiID09PSBuYW1lID8gIiM0MDlFRkYiIDogIiNkY2RmZTYiLCBib3JkZXJSYWRpdXM6ICI0cHgiIH07DQogICAgfSwNCg0KICAgIGdldFNlc3Npb24oKSB7DQogICAgICB0aGlzLiRodHRwLmdldCh0aGlzLnVzZXJUYWJsZU5hbWUgKyAnL3Nlc3Npb24nLCB7IGVtdWxhdGVKU09OOiB0cnVlIH0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgaWYgKHJlcy5kYXRhICYmIHJlcy5kYXRhLmNvZGUgPT09IDApIHsNCiAgICAgICAgICB0aGlzLnNlc3Npb25Gb3JtID0gcmVzLmRhdGEuZGF0YSB8fCB7fTsNCiAgICAgICAgICBpZiAodGhpcy5zZXNzaW9uRm9ybS50b3V4aWFuZykgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgY29uc3QgcmF3ID0gdGhpcy5zZXNzaW9uRm9ybS50b3V4aWFuZy50b1N0cmluZygpOw0KICAgICAgICAgICAgICBjb25zdCBmaWxlTmFtZSA9IHJhdy5zcGxpdCgnLycpLnBvcCgpOw0KICAgICAgICAgICAgICBpZiAoZmlsZU5hbWUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnNlc3Npb25Gb3JtLnRvdXhpYW5nID0gdGhpcy5iYXNlVXJsICsgJ2ZpbGUvZ2V0QXZhdGFyP2ZpbGVOYW1lPScgKyBlbmNvZGVVUklDb21wb25lbnQoZmlsZU5hbWUpOw0KICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuc2Vzc2lvbkZvcm0udG91eGlhbmcgPSAnJzsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCflpITnkIblpLTlg4/ot6/lvoTlpLHotKXvvJonLCBlKTsNCiAgICAgICAgICAgICAgdGhpcy5zZXNzaW9uRm9ybS50b3V4aWFuZyA9ICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSkuY2F0Y2goKGVycikgPT4gew0KICAgICAgICBjb25zb2xlLmVycm9yKCdnZXRTZXNzaW9uIOmUmeivr++8micsIGVycik7DQogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+iOt+WPluS4quS6uuS/oeaBr+Wksei0pScpOw0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIHN3aXRjaFRhYih0YWJOYW1lKSB7DQogICAgICB0aGlzLmFjdGl2ZVRhYiA9IHRhYk5hbWU7DQogICAgICB0aGlzLnRpdGxlID0gdGFiTmFtZSA9PT0gJ+S4quS6uuS/oeaBrycgPyAn5Liq5Lq65Lit5b+DJyA6IHRhYk5hbWU7DQogICAgICBpZiAodGFiTmFtZSA9PT0gJ+WPlua2iOmihOe6puS/oeaBrycpIHsgdGhpcy5wYWdlSW5kZXggPSAxOyB0aGlzLmdldENhbmNlbE9yZGVyTGlzdCgpOyB9DQogICAgfSwNCg0KICAgIG9uU3VibWl0KGZvcm1OYW1lKSB7DQogICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS52YWxpZGF0ZSh2YWxpZCA9PiB7DQogICAgICAgIGlmICh2YWxpZCkgew0KICAgICAgICAgIC8vIOW8uuWItuS7peihqOWNleagvOW8j+WPkemAge+8jOWFvOWuueWQjuerrw0KICAgICAgICAgIHRoaXMuJGh0dHAucG9zdCh0aGlzLnVzZXJUYWJsZU5hbWUgKyAnL3VwZGF0ZScsIHRoaXMuc2Vzc2lvbkZvcm0sIHsgZW11bGF0ZUpTT046IHRydWUgfSkudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgaWYgKHJlcy5kYXRhICYmIHJlcy5kYXRhLmNvZGUgPT09IDApIHsNCiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmm7TmlrDmiJDlip8nKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLmRhdGE/Lm1zZyB8fCAn5pu05paw5aSx6LSlJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4gew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcign5pu05paw5L+h5oGv5aSx6LSl77yaJywgZXJyKTsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+e9kee7nOivt+axguWksei0pe+8jOivt+mHjeivlScpOw0KICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KDQogICAgdXBkYXRlUGFzc3dvcmQoKSB7DQogICAgICB0aGlzLiRyZWZzWydwd2RGb3JtJ10udmFsaWRhdGUodmFsaWQgPT4gew0KICAgICAgICBpZiAoIXZhbGlkKSByZXR1cm47DQogICAgICAgIGlmICghdGhpcy5zZXNzaW9uRm9ybS5taW1hKSB7IHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+acquiOt+WPluWIsOWOn+WvhueggeS/oeaBrycpOyByZXR1cm47IH0NCiAgICAgICAgaWYgKHRoaXMucHdkRm9ybS5vbGRQYXNzd29yZCAhPT0gdGhpcy5zZXNzaW9uRm9ybS5taW1hKSB7IHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WOn+WvhueggemUmeivrycpOyByZXR1cm47IH0NCiAgICAgICAgY29uc3QgcGF5bG9hZCA9IHsgaWQ6IHRoaXMuc2Vzc2lvbkZvcm0uaWQsIG1pbWE6IHRoaXMucHdkRm9ybS5uZXdQYXNzd29yZCB9Ow0KICAgICAgICB0aGlzLiRodHRwLnBvc3QodGhpcy51c2VyVGFibGVOYW1lICsgJy91cGRhdGUnLCBwYXlsb2FkLCB7IGVtdWxhdGVKU09OOiB0cnVlIH0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICBpZiAocmVzLmRhdGEgJiYgcmVzLmRhdGEuY29kZSA9PT0gMCkgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCflr4bnoIHkv67mlLnmiJDlip8nKTsNCiAgICAgICAgICAgIHRoaXMucHdkRm9ybSA9IHsgb2xkUGFzc3dvcmQ6ICcnLCBuZXdQYXNzd29yZDogJycsIGNvbmZpcm1QYXNzd29yZDogJycgfTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMuZGF0YT8ubXNnIHx8ICflr4bnoIHkv67mlLnlpLHotKUnKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pLmNhdGNoKGVyciA9PiB7DQogICAgICAgICAgY29uc29sZS5lcnJvcign5L+u5pS55a+G56CB6K+35rGC5aSx6LSl77yaJywgZXJyKTsNCiAgICAgICAgICBjb25zdCBzdGF0dXMgPSBlcnIgJiYgZXJyLnN0YXR1cyA/IGVyci5zdGF0dXMgOiAoZXJyICYmIGVyci5yZXNwb25zZSAmJiBlcnIucmVzcG9uc2Uuc3RhdHVzID8gZXJyLnJlc3BvbnNlLnN0YXR1cyA6IG51bGwpOw0KICAgICAgICAgIGlmIChzdGF0dXMgPT09IDQxNSkgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6K+35rGC5qC85byP5LiN6KKr5ZCO56uv5o6l5Y+XICg0MTUp77yM6K+35qOA5p+l5ZCO56uv5piv5ZCm5YWB6K64IFBPU1Qg6KGo5Y2V5oiWSlNPTicpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfnvZHnu5zor7fmsYLlpLHotKXvvIzor7fph43or5UnKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIGF2YXRhckNsaWNrVGlwKCkgew0KICAgICAgdGhpcy4kbWVzc2FnZS5pbmZvKCfor7fngrnlh7vlt6bkvqfjgIzkv67mlLnlpLTlg4/jgI3mjInpkq7vvIzlnKjlj7PkvqfpobXpnaLkuIrkvKDmlrDlpLTlg48nKTsNCiAgICB9LA0KDQogICAgLy8g5LuF6Kem5Y+R5LiA5qyh5paH5Lu26YCJ5oup77ya6Kej5Yaz4oCc5Ye6546w5Lik5qyh6YCJ5oup5qGG4oCd55qE6Zeu6aKYDQogICAgdHJpZ2dlckF2YXRhclVwbG9hZCgpIHsNCiAgICAgIGNvbnN0IHVwbG9hZGVyID0gdGhpcy4kcmVmcy5hdmF0YXJVcGxvYWRlcjsNCiAgICAgIGlmICghdXBsb2FkZXIpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5LiK5Lyg57uE5Lu25pyq5Yid5aeL5YyWJyk7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCg0KICAgICAgLy8g5om+5YiwIGVsLXVwbG9hZCDlhoXpg6jnnJ/lrp7nmoQgaW5wdXRbdHlwZT1maWxlXQ0KICAgICAgLy8gRWxlbWVudCBVSSDlhoXpg6jlj6/og73mioogaW5wdXQg5pS+5Zyo57uE5Lu2IERPTSDlhoXvvIzpgJrov4cgJGVsIOafpeivouWNs+WPrw0KICAgICAgY29uc3QgZWwgPSB1cGxvYWRlci4kZWwgfHwgKHVwbG9hZGVyLiRyZWZzICYmIHVwbG9hZGVyLiRyZWZzLmlucHV0ICYmIHVwbG9hZGVyLiRyZWZzLmlucHV0LiRlbCkgfHwgbnVsbDsNCiAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IChlbCAmJiBlbC5xdWVyeVNlbGVjdG9yKSA/IGVsLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9ImZpbGUiXScpIDogbnVsbDsNCg0KICAgICAgaWYgKCFmaWxlSW5wdXQpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5LiK5Lyg57uE5Lu25Yqg6L295aSx6LSlJyk7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCg0KICAgICAgLy8g5riF56m65bm257uR5a6a5LiA5qyh5oCnIG9uY2hhbmdl77yM54S25ZCO6Kem5Y+RIGNsaWNrIOKAlOKAlCDlj6rop6blj5HkuIDmrKHpgInmi6nmoYYNCiAgICAgIGZpbGVJbnB1dC52YWx1ZSA9ICcnOw0KICAgICAgZmlsZUlucHV0Lm9uY2hhbmdlID0gKGUpID0+IHsNCiAgICAgICAgY29uc3QgZmlsZSA9IGUudGFyZ2V0LmZpbGVzICYmIGUudGFyZ2V0LmZpbGVzWzBdOw0KICAgICAgICBpZiAoZmlsZSkgew0KICAgICAgICAgIC8vIOS7heS9v+eUqOesrOS4gOasoemAieaLqeeahOaWh+S7tu+8iOWmguaenOeUqOaIt+mAieaLqeWQjuWPlua2iOW5tumHjeaWsOmAieaLqeS8muWGjeasoeinpuWPke+8iQ0KICAgICAgICAgIHRoaXMudXBsb2FkQXZhdGFyRmlsZShmaWxlKTsNCiAgICAgICAgfQ0KICAgICAgICAvLyDop6Pnu5HvvIzpmLLmraLph43lpI3nu5Hlrprlr7zoh7TlpJrmrKHop6blj5ENCiAgICAgICAgZmlsZUlucHV0Lm9uY2hhbmdlID0gbnVsbDsNCiAgICAgIH07DQogICAgICBmaWxlSW5wdXQuY2xpY2soKTsNCiAgICB9LA0KDQogICAgLy8g5LiK5Lyg5paH5Lu277ya5Y6f5a6e546w5L+d55WZ77yM5LuF5aKe5Yqg5LiK5Lyg54q25oCB5qCH6K6w5Lul5ZyoIFVJIOaYvuekuuKAnOS4iuS8oOS4reKAnQ0KICAgIHVwbG9hZEF2YXRhckZpbGUoZmlsZSkgew0KICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsNCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIGZpbGUpOw0KICAgICAgY29uc3QgdXBsb2FkVXJsID0gdGhpcy5iYXNlVXJsICsgJ2ZpbGUvdXBsb2FkJzsNCiAgICAgIHRoaXMudXBsb2FkaW5nID0gdHJ1ZTsNCiAgICAgIHRoaXMuJGh0dHAucG9zdCh1cGxvYWRVcmwsIGZvcm1EYXRhLCB7IGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdtdWx0aXBhcnQvZm9ybS1kYXRhJywgVG9rZW46IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdUb2tlbicpIH0gfSkudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLnVwbG9hZGluZyA9IGZhbHNlOw0KICAgICAgICBpZiAocmVzLmRhdGEgJiYgcmVzLmRhdGEuY29kZSA9PT0gMCkgew0KICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gcmVzLmRhdGEuZmlsZSB8fCAocmVzLmRhdGEuZGF0YSAmJiAocmVzLmRhdGEuZGF0YS5maWxlIHx8IHJlcy5kYXRhLmRhdGEpKSB8fCByZXMuZGF0YS51cmw7DQogICAgICAgICAgaWYgKCFmaWxlUGF0aCkgeyB0aGlzLiRtZXNzYWdlLmVycm9yKCflkI7nq6/mnKrov5Tlm57mlofku7bot6/lvoQnKTsgcmV0dXJuOyB9DQogICAgICAgICAgY29uc3QgZmlsZW5hbWVPbmx5ID0gZmlsZVBhdGgudG9TdHJpbmcoKS5zcGxpdCgnLycpLnBvcCgpOw0KICAgICAgICAgIGNvbnN0IGZ1bGxBdmF0YXJVcmwgPSB0aGlzLmJhc2VVcmwgKyAnZmlsZS9nZXRBdmF0YXI/ZmlsZU5hbWU9JyArIGVuY29kZVVSSUNvbXBvbmVudChmaWxlbmFtZU9ubHkpOw0KICAgICAgICAgIHRoaXMuc2Vzc2lvbkZvcm0udG91eGlhbmcgPSBmdWxsQXZhdGFyVXJsOw0KICAgICAgICAgIC8vIOabtOaWsOeUqOaIt+WktOWDj+WIsOaVsOaNruW6k++8iOS9v+eUqCBlbXVsYXRlSlNPTiDkv53mjIHlhbzlrrnvvIkNCiAgICAgICAgICB0aGlzLiRodHRwLnBvc3QodGhpcy51c2VyVGFibGVOYW1lICsgJy91cGRhdGUnLCB7IGlkOiB0aGlzLnNlc3Npb25Gb3JtLmlkLCB0b3V4aWFuZzogZmlsZVBhdGggfSwgeyBlbXVsYXRlSlNPTjogdHJ1ZSB9KS50aGVuKHVwZGF0ZVJlcyA9PiB7DQogICAgICAgICAgICBpZiAodXBkYXRlUmVzLmRhdGEgJiYgdXBkYXRlUmVzLmRhdGEuY29kZSA9PT0gMCkgew0KICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+WktOWDj+S4iuS8oOaIkOWKnycpOw0KICAgICAgICAgICAgICB0aGlzLnN3aXRjaFRhYign5Liq5Lq65L+h5oGvJyk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHVwZGF0ZVJlcy5kYXRhPy5tc2cgfHwgJ+WktOWDj+abtOaWsOWksei0pe+8jOivt+mHjeivlScpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pLmNhdGNoKGVyciA9PiB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCflpLTlg4/mm7TmlrDor7fmsYLlpLHotKXvvJonLCBlcnIpOw0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5aS05YOP5pu05paw6K+35rGC5aSx6LSlJyk7DQogICAgICAgICAgfSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMuZGF0YT8ubXNnIHx8ICflpLTlg4/kuIrkvKDlpLHotKUnKTsNCiAgICAgICAgfQ0KICAgICAgfSkuY2F0Y2goZXJyID0+IHsNCiAgICAgICAgdGhpcy51cGxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgY29uc29sZS5lcnJvcign5paH5Lu25LiK5Lyg5aSx6LSl77yaJywgZXJyKTsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign572R57uc5byC5bi477yM5LiK5Lyg5aSx6LSlJyk7DQogICAgICB9KTsNCiAgICB9LA0KDQogICAgc2VhcmNoQ2FuY2VsT3JkZXIoKSB7IHRoaXMucGFnZUluZGV4ID0gMTsgdGhpcy5nZXRDYW5jZWxPcmRlckxpc3QoKTsgfSwNCg0KICAgIGdldENhbmNlbE9yZGVyTGlzdCgpIHsNCiAgICAgIGlmICghdGhpcy5zZXNzaW9uRm9ybS54dWVoYW8pIHsgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfmnKrojrflj5bliLDlrablj7fkv6Hmga/vvIzml6Dms5Xmn6Xor6Llj5bmtojpooTnuqborrDlvZUnKTsgdGhpcy5jYW5jZWxPcmRlckxvYWRpbmcgPSBmYWxzZTsgcmV0dXJuOyB9DQogICAgICB0aGlzLmNhbmNlbE9yZGVyTG9hZGluZyA9IHRydWU7DQogICAgICBjb25zdCBwYXJhbXMgPSB7IHBhZ2U6IHRoaXMucGFnZUluZGV4LCBsaW1pdDogdGhpcy5wYWdlU2l6ZSwgc29ydDogJ2lkJywgb3JkZXI6ICdkZXNjJywgeHVlaGFvOiB0aGlzLnNlc3Npb25Gb3JtLnh1ZWhhbyB9Ow0KICAgICAgaWYgKHRoaXMuc2VhcmNoRm9ybS55dXl1ZWRhbmhhbykgcGFyYW1zLnl1eXVlZGFuaGFvID0gYCUke3RoaXMuc2VhcmNoRm9ybS55dXl1ZWRhbmhhb30lYDsNCiAgICAgIHRoaXMuJGh0dHAoeyB1cmw6ICdxdXhpYW95dXl1ZS9wYWdlJywgbWV0aG9kOiAnZ2V0JywgcGFyYW1zIH0pLnRoZW4oKHsgZGF0YSB9KSA9PiB7DQogICAgICAgIHRoaXMuY2FuY2VsT3JkZXJMb2FkaW5nID0gZmFsc2U7DQogICAgICAgIGlmIChkYXRhICYmIGRhdGEuY29kZSA9PT0gMCkgeyB0aGlzLmNhbmNlbE9yZGVyTGlzdCA9IGRhdGEuZGF0YS5saXN0IHx8IFtdOyB0aGlzLnRvdGFsUGFnZSA9IGRhdGEuZGF0YS50b3RhbCB8fCAwOyB9DQogICAgICAgIGVsc2UgeyB0aGlzLmNhbmNlbE9yZGVyTGlzdCA9IFtdOyB0aGlzLnRvdGFsUGFnZSA9IDA7IHRoaXMuJG1lc3NhZ2Uud2FybmluZyhkYXRhPy5tc2cgfHwgJ+aaguaXoOWPlua2iOmihOe6puiusOW9lScpOyB9DQogICAgICB9KS5jYXRjaCgoKSA9PiB7DQogICAgICAgIHRoaXMuY2FuY2VsT3JkZXJMaXN0ID0gW107IHRoaXMudG90YWxQYWdlID0gMDsgdGhpcy5jYW5jZWxPcmRlckxvYWRpbmcgPSBmYWxzZTsgdGhpcy4kbWVzc2FnZS5lcnJvcign6I635Y+W5Y+W5raI6aKE57qm6K6w5b2V5aSx6LSlJyk7DQogICAgICB9KTsNCiAgICB9LA0KDQogICAgc2l6ZUNoYW5nZUhhbmRsZSh2YWwpIHsgdGhpcy5wYWdlU2l6ZSA9IHZhbDsgdGhpcy5nZXRDYW5jZWxPcmRlckxpc3QoKTsgfSwNCiAgICBjdXJyZW50Q2hhbmdlSGFuZGxlKHZhbCkgeyB0aGlzLnBhZ2VJbmRleCA9IHZhbDsgdGhpcy5nZXRDYW5jZWxPcmRlckxpc3QoKTsgfQ0KICB9DQp9DQo="},{"version":3,"sources":["center.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6HA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"center.vue","sourceRoot":"src/pages/center","sourcesContent":["<template>\r\n  <div :style='{\"width\":\"80%\",\"margin\":\"10px auto\",\"position\":\"relative\",\"background\":\"#fff\",\"boxShadow\":\"0px 4px 10px 0px rgba(0,0,0,0.302)\"}'>\r\n    <!-- 标题等同你现有布局（保持不变） -->\r\n    <div class=\"title\" :style='{\"margin\":\"0\",\"color\":\"#333\",\"textAlign\":\"center\",\"background\":\"rgba(0,0,0,0.102)\",\"fontSize\":\"20px\",\"lineHeight\":\"54px\",\"fontWeight\":\"600\"}'>{{ title }}</div>\r\n\r\n    <div :style='{\"display\":\"flex\",\"padding\":\"20px\"}'>\r\n      <div :style='{\"width\":\"180px\",\"textAlign\":\"center\",\"background\":\"#f5f7fa\",\"borderRadius\":\"8px\",\"padding\":\"20px\",\"marginRight\":\"20px\"}'>\r\n        <div :style='{\"marginBottom\":\"15px\",\"cursor\":\"pointer\"}' @click=\"avatarClickTip\">\r\n          <img\r\n              v-if=\"sessionForm.touxiang\"\r\n              :src=\"sessionForm.touxiang\"\r\n              :style='{\"width\":\"100px\",\"height\":\"100px\",\"borderRadius\":\"50%\",\"border\":\"2px solid #fff\",\"boxShadow\":\"0 2px 8px rgba(0,0,0,0.1)\"}'\r\n          />\r\n          <div\r\n              v-else\r\n              :style='{\"width\":\"100px\",\"height\":\"100px\",\"borderRadius\":\"50%\",\"background\":\"#e6f0ff\",\"color\":\"#409eff\",\"fontSize\":\"36px\",\"lineHeight\":\"100px\",\"display\":\"inline-block\",\"textAlign\":\"center\"}'>\r\n            <i class=\"el-icon-user\"></i>\r\n          </div>\r\n\r\n          <!-- 保留 el-upload，但不要在里面手动放 <input>（这会导致页面上出现两个 file input，进而触发两次选择框） -->\r\n          <el-upload\r\n              ref=\"avatarUploader\"\r\n              class=\"avatar-uploader\"\r\n              :action=\"uploadUrl\"\r\n              :headers=\"headers\"\r\n              :show-file-list=\"false\"\r\n              :auto-upload=\"false\"\r\n              style=\"display: none;\">\r\n          </el-upload>\r\n        </div>\r\n\r\n        <div :style='{\"fontSize\":\"14px\",\"color\":\"#333\",\"padding\":\"8px 0\",\"background\":\"#fff\",\"borderRadius\":\"4px\",\"marginBottom\":\"20px\"}'>\r\n          学号：{{ sessionForm.xuehao || '未填写' }}\r\n        </div>\r\n\r\n        <div :style='{\"display\":\"flex\",\"flexDirection\":\"column\",\"gap\":\"10px\"}'>\r\n          <el-button type=\"primary\" plain @click=\"switchTab('个人信息')\" :style=\"tabStyle('个人信息')\">个人信息</el-button>\r\n          <el-button type=\"primary\" plain @click=\"switchTab('修改头像')\" :style=\"tabStyle('修改头像')\">修改头像</el-button>\r\n          <el-button type=\"primary\" plain @click=\"switchTab('修改密码')\" :style=\"tabStyle('修改密码')\">修改密码</el-button>\r\n          <el-button type=\"primary\" plain @click=\"switchTab('取消预约信息')\" :style=\"tabStyle('取消预约信息')\">取消预约信息</el-button>\r\n        </div>\r\n      </div>\r\n\r\n      <div :style='{\"flex\":\"1\",\"background\":\"#f5f7fa\",\"borderRadius\":\"8px\",\"padding\":\"20px\"}'>\r\n        <div v-if=\"activeTab === '个人信息'\" :style='{\"background\":\"#fff\",\"borderRadius\":\"8px\",\"padding\":\"20px\",\"boxShadow\":\"0 2px 8px rgba(0,0,0,0.05)\"}'>\r\n          <el-form ref=\"sessionForm\" :model=\"sessionForm\" :rules=\"rules\" label-width=\"80px\" :style='{\"width\":\"100%\",\"maxWidth\":\"500px\",\"margin\":\"0 auto\"}'>\r\n            <el-form-item label=\"姓名\" prop=\"xingming\" :style='{\"marginBottom\":\"20px\"}'>\r\n              <el-input v-model=\"sessionForm.xingming\" placeholder=\"姓名\" style=\"width: 300px;\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"性别\" :style='{\"marginBottom\":\"20px\"}'>\r\n              <el-select v-model=\"sessionForm.xingbie\" placeholder=\"请选择性别\" style=\"width: 300px;\">\r\n                <el-option label=\"男\" value=\"男\"></el-option>\r\n                <el-option label=\"女\" value=\"女\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"手机\" prop=\"shouji\" :style='{\"marginBottom\":\"20px\"}'>\r\n              <el-input v-model=\"sessionForm.shouji\" placeholder=\"手机\" style=\"width: 300px;\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"班级\" prop=\"banji\" :style='{\"marginBottom\":\"20px\"}'>\r\n              <el-input v-model=\"sessionForm.banji\" placeholder=\"班级\" style=\"width: 300px;\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <el-button type=\"primary\" @click=\"onSubmit('sessionForm')\" :style='{\"background\":\"#409EFF\",\"color\":\"#fff\",\"border\":\"none\",\"padding\":\"0 20px\",\"height\":\"40px\"}'>更新信息</el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n        </div>\r\n\r\n        <div v-if=\"activeTab === '修改头像'\" :style='{\"background\":\"#fff\",\"borderRadius\":\"8px\",\"padding\":\"30px 40px\",\"textAlign\":\"center\",\"boxShadow\":\"0 2px 8px rgba(0,0,0,0.05)\"}'>\r\n          <p :style='{\"fontSize\":\"16px\",\"color\":\"#666\",\"marginBottom\":\"30px\"}'>点击下方按钮选择新头像上传</p>\r\n          <!-- 这里使用单一按钮，点击后只会触发一次文件选择 -->\r\n          <el-button type=\"primary\" @click=\"triggerAvatarUpload\" class=\"upload-btn\">上传头像</el-button>\r\n          <div v-if=\"uploading\" style=\"margin-top:12px;color:#999\">上传中，请稍候…</div>\r\n        </div>\r\n\r\n        <div v-if=\"activeTab === '修改密码'\" class=\"pwd-card\">\r\n          <el-form ref=\"pwdForm\" :model=\"pwdForm\" :rules=\"pwdRules\" label-width=\"120px\" class=\"pwd-form\">\r\n            <el-form-item label=\"原密码\" prop=\"oldPassword\">\r\n              <el-input v-model=\"pwdForm.oldPassword\" type=\"password\" placeholder=\"请输入原密码\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"新密码\" prop=\"newPassword\">\r\n              <el-input v-model=\"pwdForm.newPassword\" type=\"password\" placeholder=\"请输入新密码\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"确认密码\" prop=\"confirmPassword\">\r\n              <el-input v-model=\"pwdForm.confirmPassword\" type=\"password\" placeholder=\"请确认新密码\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <el-button type=\"primary\" class=\"pwd-submit\" @click=\"updatePassword\">确认修改</el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n        </div>\r\n\r\n        <div v-if=\"activeTab === '取消预约信息'\" :style='{\"width\":\"100%\"}'>\r\n          <div :style='{\"fontSize\":\"18px\",\"color\":\"#333\",\"fontWeight\":\"500\",\"marginBottom\":\"20px\",\"paddingBottom\":\"10px\",\"borderBottom\":\"1px solid #eee\"}'>取消预约信息</div>\r\n          <div :style='{\"background\":\"#fff\",\"borderRadius\":\"8px\",\"padding\":\"20px\",\"boxShadow\":\"0 2px 8px rgba(0,0,0,0.05)\",\"marginBottom\":\"20px\"}'>\r\n            <el-form :style=\"{ width: '100%', display: 'flex', alignItems: 'center', gap: '15px' }\" :inline=\"true\" :model=\"searchForm\">\r\n              <div :style=\"{ display: 'flex', flexDirection: 'column', flex: 1 }\">\r\n                <label :style=\"{ color: '#333', fontSize: '14px', fontWeight: '500', marginBottom: '4px' }\">预约单号</label>\r\n                <el-input v-model=\"searchForm.yuyuedanhao\" placeholder=\"输入预约单号查询\" clearable :style=\"{ width: '100%', borderColor: '#78abc3' }\"></el-input>\r\n              </div>\r\n              <el-button type=\"success\" @click=\"searchCancelOrder\" :style='{\"border\":\"1px solid #97C9D6\",\"color\":\"#fff\",\"background\":\"#4fc08d\",\"borderRadius\":\"20px\",\"height\":\"40px\",\"padding\":\"0 18px\"}'>查询</el-button>\r\n            </el-form>\r\n          </div>\r\n\r\n          <div :style='{\"background\":\"#fff\",\"borderRadius\":\"8px\",\"boxShadow\":\"0 2px 8px rgba(0,0,0,0.05)\",\"overflow\":\"hidden\"}'>\r\n            <el-table class=\"custom-table\" :style=\"{ width: '100%' }\" :data=\"cancelOrderList\" v-loading=\"cancelOrderLoading\" border :header-cell-style=\"{ background: '#f8f9fa', color: '#495057', fontWeight: '600' }\" :row-style=\"{ height: '45px' }\">\r\n              <el-table-column type=\"index\" label=\"索引\" width=\"80\" align=\"center\"></el-table-column>\r\n              <el-table-column prop=\"yuyuedanhao\" label=\"预约单号\" min-width=\"150\" align=\"center\"></el-table-column>\r\n              <el-table-column prop=\"mingcheng\" label=\"名称\" min-width=\"120\" align=\"center\"></el-table-column>\r\n              <el-table-column prop=\"yuyueStart\" label=\"预约开始时间\" min-width=\"180\" align=\"center\"></el-table-column>\r\n              <el-table-column prop=\"yuyueEnd\" label=\"预约结束时间\" min-width=\"180\" align=\"center\"></el-table-column>\r\n              <el-table-column prop=\"quxiaoshijian\" label=\"取消时间\" min-width=\"180\" align=\"center\"></el-table-column>\r\n              <el-table-column prop=\"xuehao\" label=\"学号\" min-width=\"120\" align=\"center\"></el-table-column>\r\n              <el-table-column prop=\"xingming\" label=\"姓名\" min-width=\"120\" align=\"center\"></el-table-column>\r\n              <el-table-column prop=\"shouji\" label=\"手机\" min-width=\"150\" align=\"center\"></el-table-column>\r\n            </el-table>\r\n          </div>\r\n\r\n          <el-pagination @size-change=\"sizeChangeHandle\" @current-change=\"currentChangeHandle\" :current-page=\"pageIndex\" background :page-sizes=\"[10,20,30,50]\" :page-size=\"pageSize\" :layout=\"'total, prev, pager, next, sizes, jumper'\" :total=\"totalPage\" :style=\"{ width: '100%', margin: '20px 0 0', textAlign: 'right' }\"></el-pagination>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport config from '@/config/config'\r\n\r\nexport default {\r\n  data() {\r\n    const validateMobile = (rule, value, callback) => {\r\n      if (!value) {\r\n        callback();\r\n      } else {\r\n        const mobileReg = /^1[3-9]\\d{9}$/;\r\n        if (!mobileReg.test(value)) {\r\n          callback(new Error(\"请输入正确的手机号码\"));\r\n        } else {\r\n          callback();\r\n        }\r\n      }\r\n    };\r\n\r\n    const vm = this;\r\n\r\n    return {\r\n      title: '个人中心',\r\n      activeTab: '个人信息',\r\n      baseUrl: config.baseUrl,\r\n      sessionForm: {},\r\n      pwdForm: { oldPassword: '', newPassword: '', confirmPassword: '' },\r\n      rules: { xingming: [{ required: true, message: '请输入姓名', trigger: 'blur' }], shouji: [{ validator: validateMobile, trigger: 'blur' }] },\r\n      pwdRules: {\r\n        oldPassword: [{ required: true, message: '请输入原密码', trigger: 'blur' }],\r\n        newPassword: [{ required: true, message: '请输入新密码', trigger: 'blur' }, { min: 6, message: '密码长度不能少于6位', trigger: 'blur' }],\r\n        confirmPassword: [{ required: true, message: '请确认新密码', trigger: 'blur' },\r\n          { validator: function(rule, value, callback) { if (value !== vm.pwdForm.newPassword) callback(new Error('两次密码不一致')); else callback(); }, trigger: 'blur' }]\r\n      },\r\n      uploadUrl: config.baseUrl + 'file/upload',\r\n      headers: { Token: localStorage.getItem('Token') },\r\n      userTableName: localStorage.getItem('UserTableName'),\r\n      searchForm: { yuyuedanhao: '' },\r\n      cancelOrderList: [], cancelOrderLoading: false, pageIndex: 1, pageSize: 10, totalPage: 0,\r\n      uploading: false\r\n    }\r\n  },\r\n  created() {\r\n    this.getSession();\r\n  },\r\n  methods: {\r\n    tabStyle(name) {\r\n      return { width: \"100%\", background: this.activeTab === name ? \"#409EFF\" : \"#fff\", color: this.activeTab === name ? \"#fff\" : \"#409EFF\", borderColor: this.activeTab === name ? \"#409EFF\" : \"#dcdfe6\", borderRadius: \"4px\" };\r\n    },\r\n\r\n    getSession() {\r\n      this.$http.get(this.userTableName + '/session', { emulateJSON: true }).then(res => {\r\n        if (res.data && res.data.code === 0) {\r\n          this.sessionForm = res.data.data || {};\r\n          if (this.sessionForm.touxiang) {\r\n            try {\r\n              const raw = this.sessionForm.touxiang.toString();\r\n              const fileName = raw.split('/').pop();\r\n              if (fileName) {\r\n                this.sessionForm.touxiang = this.baseUrl + 'file/getAvatar?fileName=' + encodeURIComponent(fileName);\r\n              } else {\r\n                this.sessionForm.touxiang = '';\r\n              }\r\n            } catch (e) {\r\n              console.error('处理头像路径失败：', e);\r\n              this.sessionForm.touxiang = '';\r\n            }\r\n          }\r\n        }\r\n      }).catch((err) => {\r\n        console.error('getSession 错误：', err);\r\n        this.$message.error('获取个人信息失败');\r\n      });\r\n    },\r\n\r\n    switchTab(tabName) {\r\n      this.activeTab = tabName;\r\n      this.title = tabName === '个人信息' ? '个人中心' : tabName;\r\n      if (tabName === '取消预约信息') { this.pageIndex = 1; this.getCancelOrderList(); }\r\n    },\r\n\r\n    onSubmit(formName) {\r\n      this.$refs[formName].validate(valid => {\r\n        if (valid) {\r\n          // 强制以表单格式发送，兼容后端\r\n          this.$http.post(this.userTableName + '/update', this.sessionForm, { emulateJSON: true }).then(res => {\r\n            if (res.data && res.data.code === 0) {\r\n              this.$message.success('更新成功');\r\n            } else {\r\n              this.$message.error(res.data?.msg || '更新失败');\r\n            }\r\n          }).catch((err) => {\r\n            console.error('更新信息失败：', err);\r\n            this.$message.error('网络请求失败，请重试');\r\n          });\r\n        }\r\n      });\r\n    },\r\n\r\n    updatePassword() {\r\n      this.$refs['pwdForm'].validate(valid => {\r\n        if (!valid) return;\r\n        if (!this.sessionForm.mima) { this.$message.error('未获取到原密码信息'); return; }\r\n        if (this.pwdForm.oldPassword !== this.sessionForm.mima) { this.$message.error('原密码错误'); return; }\r\n        const payload = { id: this.sessionForm.id, mima: this.pwdForm.newPassword };\r\n        this.$http.post(this.userTableName + '/update', payload, { emulateJSON: true }).then(res => {\r\n          if (res.data && res.data.code === 0) {\r\n            this.$message.success('密码修改成功');\r\n            this.pwdForm = { oldPassword: '', newPassword: '', confirmPassword: '' };\r\n          } else {\r\n            this.$message.error(res.data?.msg || '密码修改失败');\r\n          }\r\n        }).catch(err => {\r\n          console.error('修改密码请求失败：', err);\r\n          const status = err && err.status ? err.status : (err && err.response && err.response.status ? err.response.status : null);\r\n          if (status === 415) {\r\n            this.$message.error('请求格式不被后端接受 (415)，请检查后端是否允许 POST 表单或JSON');\r\n          } else {\r\n            this.$message.error('网络请求失败，请重试');\r\n          }\r\n        });\r\n      });\r\n    },\r\n\r\n    avatarClickTip() {\r\n      this.$message.info('请点击左侧「修改头像」按钮，在右侧页面上传新头像');\r\n    },\r\n\r\n    // 仅触发一次文件选择：解决“出现两次选择框”的问题\r\n    triggerAvatarUpload() {\r\n      const uploader = this.$refs.avatarUploader;\r\n      if (!uploader) {\r\n        this.$message.error('上传组件未初始化');\r\n        return;\r\n      }\r\n\r\n      // 找到 el-upload 内部真实的 input[type=file]\r\n      // Element UI 内部可能把 input 放在组件 DOM 内，通过 $el 查询即可\r\n      const el = uploader.$el || (uploader.$refs && uploader.$refs.input && uploader.$refs.input.$el) || null;\r\n      const fileInput = (el && el.querySelector) ? el.querySelector('input[type=\"file\"]') : null;\r\n\r\n      if (!fileInput) {\r\n        this.$message.error('上传组件加载失败');\r\n        return;\r\n      }\r\n\r\n      // 清空并绑定一次性 onchange，然后触发 click —— 只触发一次选择框\r\n      fileInput.value = '';\r\n      fileInput.onchange = (e) => {\r\n        const file = e.target.files && e.target.files[0];\r\n        if (file) {\r\n          // 仅使用第一次选择的文件（如果用户选择后取消并重新选择会再次触发）\r\n          this.uploadAvatarFile(file);\r\n        }\r\n        // 解绑，防止重复绑定导致多次触发\r\n        fileInput.onchange = null;\r\n      };\r\n      fileInput.click();\r\n    },\r\n\r\n    // 上传文件：原实现保留，仅增加上传状态标记以在 UI 显示“上传中”\r\n    uploadAvatarFile(file) {\r\n      const formData = new FormData();\r\n      formData.append('file', file);\r\n      const uploadUrl = this.baseUrl + 'file/upload';\r\n      this.uploading = true;\r\n      this.$http.post(uploadUrl, formData, { headers: { 'Content-Type': 'multipart/form-data', Token: localStorage.getItem('Token') } }).then(res => {\r\n        this.uploading = false;\r\n        if (res.data && res.data.code === 0) {\r\n          const filePath = res.data.file || (res.data.data && (res.data.data.file || res.data.data)) || res.data.url;\r\n          if (!filePath) { this.$message.error('后端未返回文件路径'); return; }\r\n          const filenameOnly = filePath.toString().split('/').pop();\r\n          const fullAvatarUrl = this.baseUrl + 'file/getAvatar?fileName=' + encodeURIComponent(filenameOnly);\r\n          this.sessionForm.touxiang = fullAvatarUrl;\r\n          // 更新用户头像到数据库（使用 emulateJSON 保持兼容）\r\n          this.$http.post(this.userTableName + '/update', { id: this.sessionForm.id, touxiang: filePath }, { emulateJSON: true }).then(updateRes => {\r\n            if (updateRes.data && updateRes.data.code === 0) {\r\n              this.$message.success('头像上传成功');\r\n              this.switchTab('个人信息');\r\n            } else {\r\n              this.$message.error(updateRes.data?.msg || '头像更新失败，请重试');\r\n            }\r\n          }).catch(err => {\r\n            console.error('头像更新请求失败：', err);\r\n            this.$message.error('头像更新请求失败');\r\n          });\r\n        } else {\r\n          this.$message.error(res.data?.msg || '头像上传失败');\r\n        }\r\n      }).catch(err => {\r\n        this.uploading = false;\r\n        console.error('文件上传失败：', err);\r\n        this.$message.error('网络异常，上传失败');\r\n      });\r\n    },\r\n\r\n    searchCancelOrder() { this.pageIndex = 1; this.getCancelOrderList(); },\r\n\r\n    getCancelOrderList() {\r\n      if (!this.sessionForm.xuehao) { this.$message.warning('未获取到学号信息，无法查询取消预约记录'); this.cancelOrderLoading = false; return; }\r\n      this.cancelOrderLoading = true;\r\n      const params = { page: this.pageIndex, limit: this.pageSize, sort: 'id', order: 'desc', xuehao: this.sessionForm.xuehao };\r\n      if (this.searchForm.yuyuedanhao) params.yuyuedanhao = `%${this.searchForm.yuyuedanhao}%`;\r\n      this.$http({ url: 'quxiaoyuyue/page', method: 'get', params }).then(({ data }) => {\r\n        this.cancelOrderLoading = false;\r\n        if (data && data.code === 0) { this.cancelOrderList = data.data.list || []; this.totalPage = data.data.total || 0; }\r\n        else { this.cancelOrderList = []; this.totalPage = 0; this.$message.warning(data?.msg || '暂无取消预约记录'); }\r\n      }).catch(() => {\r\n        this.cancelOrderList = []; this.totalPage = 0; this.cancelOrderLoading = false; this.$message.error('获取取消预约记录失败');\r\n      });\r\n    },\r\n\r\n    sizeChangeHandle(val) { this.pageSize = val; this.getCancelOrderList(); },\r\n    currentChangeHandle(val) { this.pageIndex = val; this.getCancelOrderList(); }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n/* 全局样式调整 */\r\n.el-form-item >>> .el-form-item__label {\r\n  color: #333;\r\n  font-weight: 500;\r\n  text-align: right;\r\n  line-height: 40px;\r\n}\r\n.el-input >>> .el-input__inner {\r\n  border: 1px solid #ccc;\r\n  border-radius: 6px;\r\n  height: 40px;\r\n  padding: 0 12px;\r\n  transition: box-shadow .2s;\r\n}\r\n.el-input >>> .el-input__inner:focus {\r\n  box-shadow: 0 0 6px rgba(64,158,255,0.12);\r\n  border-color: #409EFF;\r\n}\r\n\r\n.el-select >>> .el-input__inner {\r\n  border: 1px solid #ccc;\r\n  border-radius: 6px;\r\n  height: 40px;\r\n  padding: 0 12px;\r\n}\r\n\r\n/* 上传按钮风格 */\r\n.upload-btn {\r\n  border-radius: 8px;\r\n  padding: 8px 18px;\r\n  background: linear-gradient(90deg,#4aa8ff,#2f86f6);\r\n  color: #fff;\r\n  box-shadow: 0 6px 18px rgba(47,134,246,0.12);\r\n}\r\n\r\n/* 修改密码卡片美化 */\r\n.pwd-card {\r\n  background:#fff;\r\n  border-radius:8px;\r\n  padding: 28px;\r\n  box-shadow: 0 2px 8px rgba(0,0,0,0.04);\r\n  max-width:640px;\r\n  margin:0 auto;\r\n}\r\n.pwd-form .el-form-item {\r\n  margin-bottom: 18px;\r\n}\r\n.pwd-form .el-form-item .el-input__inner {\r\n  border-radius: 6px;\r\n  height: 44px;\r\n  padding: 0 14px;\r\n}\r\n\r\n/* 更好看的确认按钮 */\r\n.pwd-submit {\r\n  background: linear-gradient(90deg,#ffb980,#ff8a65);\r\n  border: none;\r\n  color: #fff;\r\n  border-radius: 24px;\r\n  padding: 10px 22px;\r\n  box-shadow: 0 6px 18px rgba(255,138,101,0.12);\r\n}\r\n\r\n/* 取消预约列表样式优化 */\r\n.custom-table {\r\n  .el-table__body-wrapper tr:hover td {\r\n    background: rgba(147, 199, 179, 0.05);\r\n  }\r\n}\r\n</style>"]}]}