{"remainingRequest":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\src\\pages\\zixishi\\detail.vue?vue&type=style&index=0&id=6672edf0&rel=stylesheet%2Fscss&lang=scss&scoped=true&","dependencies":[{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\src\\pages\\zixishi\\detail.vue","mtime":1765808727920},{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1765241852000},{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQovLyDpnaLljIXlsZHmoLflvI8NCi5icmVhZGNydW1iLXByZXZpZXcgew0KICA6OnYtZGVlcCAuZWwtYnJlYWRjcnVtYl9fc2VwYXJhdG9yIHsNCiAgICBtYXJnaW46IDAgNXB4Ow0KICAgIGNvbG9yOiAjNjY2Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogIH0NCiAgOjp2LWRlZXAgLmVsLWJyZWFkY3J1bWJfX2lubmVyIGEgew0KICAgIGNvbG9yOiAjNjY2Ow0KICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgfQ0KICA6OnYtZGVlcCAuZWwtYnJlYWRjcnVtYl9faW5uZXIgew0KICAgIGNvbG9yOiAjNjY2Ow0KICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgfQ0KfQ0KDQovLyDova7mkq3lm77moLflvI8NCi5lbC1jYXJvdXNlbCA+Pj4gLmVsLWNhcm91c2VsX19pbmRpY2F0b3IgYnV0dG9uIHsNCiAgd2lkdGg6IDEwcHg7DQogIGhlaWdodDogMTBweDsNCiAgYm9yZGVyLXJhZGl1czogMTBweDsNCiAgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwwLjUpOw0KICBtYXJnaW46IDAgNHB4Ow0KfQ0KLmVsLWNhcm91c2VsID4+PiAuZWwtY2Fyb3VzZWxfX2luZGljYXRvcnMgbGkuaXMtYWN0aXZlIHsNCiAgd2lkdGg6IDIwcHg7DQogIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgYmFja2dyb3VuZDogI2ZmZjsNCn0NCg0KLy8g5bqn5L2N5qC35byP5LyY5YyWDQouc2VhdC1pdGVtIHsNCiAgLy8g5Y+v6YCJ5bqn5L2N5oKs5YGc5pWI5p6cDQogICYuc2VhdC1hdmFpbGFibGU6bm90KC5zZWF0LXNlbGVjdGVkKTpob3ZlciB7DQogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjA1KTsNCiAgICBib3gtc2hhZG93OiAwIDRweCA4cHggcmdiYSg0NiwgOTcsIDIyNSwgMC4xNSk7DQogICAgYm9yZGVyLWNvbG9yOiAjMUU0Q0Q4ICFpbXBvcnRhbnQ7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICB9DQoNCiAgLy8g5bey6YCJ5bqn5L2N5Yqo55S75pWI5p6cDQogICYuc2VhdC1zZWxlY3RlZCB7DQogICAgYm94LXNoYWRvdzogMCAwIDAgM3B4IHJnYmEoNDYsIDk3LCAyMjUsIDAuMyk7DQogICAgYW5pbWF0aW9uOiBwdWxzZSAxLjVzIGluZmluaXRlOw0KICAgIGJhY2tncm91bmQ6ICNlNmY3ZmY7IC8qIOa1heiTneiJsuiDjOaZryAqLw0KICB9DQoNCiAgLy8g5bey5Y2g55So5bqn5L2N5qC35byP5by65YyWDQogICYuc2VhdC1vY2N1cGllZCB7DQogICAgYmFja2dyb3VuZDogI2Y4ZDdkYTsgLyog5rWF57qi6Imy6IOM5pmvICovDQogICAgY3Vyc29yOiBub3QtYWxsb3dlZDsNCiAgICBvcGFjaXR5OiAwLjg7DQogIH0NCn0NCg0KLy8g6ISJ5Yay5Yqo55S7DQpAa2V5ZnJhbWVzIHB1bHNlIHsNCiAgMCUgew0KICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSg0NiwgOTcsIDIyNSwgMC40KTsNCiAgfQ0KICA3MCUgew0KICAgIGJveC1zaGFkb3c6IDAgMCAwIDZweCByZ2JhKDQ2LCA5NywgMjI1LCAwKTsNCiAgfQ0KICAxMDAlIHsNCiAgICBib3gtc2hhZG93OiAwIDAgMCAwIHJnYmEoNDYsIDk3LCAyMjUsIDApOw0KICB9DQp9DQoNCi8vICoqKioqKioqIOaWsOWinu+8muaXtumXtOadoeagt+W8jyAqKioqKioqKg0KLnRpbWUtYmFyLWNvbnRhaW5lciB7DQogIGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7DQogIHBhZGRpbmc6IDEwcHg7DQogIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgbWF4LXdpZHRoOiA3NjBweDsgLyog6ZmQ5Yi25a695bqmICovDQogIG1hcmdpbjogMCBhdXRvOw0KfQ0KLnRpbWUtYmFyLWhlYWRlciB7DQogIGRpc3BsYXk6IGZsZXg7DQogIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDsNCiAgZm9udC1zaXplOiAxMHB4Ow0KICBjb2xvcjogIzY2NjsNCiAgbWFyZ2luLWJvdHRvbTogNXB4Ow0KICBwYWRkaW5nLWxlZnQ6IDFweDsgLyog5a+56b2Q56ys5LiA5Liq5pe26Ze05Yi75bqmICovDQp9DQoudGltZS1iYXItaGVhZGVyIHNwYW4gew0KICB0ZXh0LWFsaWduOiBsZWZ0Ow0KICB3aGl0ZS1zcGFjZTogbm93cmFwOw0KICBwb3NpdGlvbjogcmVsYXRpdmU7DQp9DQoudGltZS1iYXItaGVhZGVyIHNwYW46Zmlyc3QtY2hpbGQ6OmJlZm9yZSB7DQogIGNvbnRlbnQ6ICcnOw0KICBwb3NpdGlvbjogYWJzb2x1dGU7DQogIGxlZnQ6IDA7DQogIHRvcDogLTVweDsNCiAgaGVpZ2h0OiAxMHB4Ow0KICBib3JkZXItbGVmdDogMXB4IHNvbGlkICNjY2M7DQp9DQoudGltZS1iYXItaGVhZGVyIHNwYW46OmFmdGVyIHsNCiAgY29udGVudDogJyc7DQogIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgcmlnaHQ6IDA7DQogIHRvcDogLTVweDsNCiAgaGVpZ2h0OiAxMHB4Ow0KICBib3JkZXItbGVmdDogMXB4IHNvbGlkICNjY2M7DQp9DQoNCi50aW1lLWJhci1ib2R5IHsNCiAgZGlzcGxheTogZmxleDsNCiAgaGVpZ2h0OiA0MHB4Ow0KICBib3JkZXI6IDFweCBzb2xpZCAjY2NjOw0KICBib3JkZXItcmFkaXVzOiA0cHg7DQogIG92ZXJmbG93OiBoaWRkZW47DQogIGJveC1zaXppbmc6IGNvbnRlbnQtYm94Ow0KfQ0KLnRpbWUtc2xvdCB7DQogIHdpZHRoOiA3LjE0Mjg1NyU7IC8qIDEwMCUgLyAxNCBzbG90cyAoODowMC0yMjowMCkgKi8NCiAgaGVpZ2h0OiAxMDAlOw0KICBjdXJzb3I6IGRlZmF1bHQ7DQogIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4zczsNCn0NCg0KLnNsb3QtZnJlZSB7DQogIGJhY2tncm91bmQtY29sb3I6ICNkNGVkZGE7IC8qIExpZ2h0IGdyZWVuICovDQogIGJvcmRlci1yaWdodDogMXB4IGRhc2hlZCAjODg4Ow0KfQ0KLnNsb3QtYm9va2VkIHsNCiAgYmFja2dyb3VuZC1jb2xvcjogI2Y4ZDdkYTsgLyogTGlnaHQgcmVkICovDQogIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICM4ODg7DQogIGN1cnNvcjogbm90LWFsbG93ZWQ7DQp9DQoubGVnZW5kLWl0ZW0gew0KICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogIHdpZHRoOiAyMHB4Ow0KICBoZWlnaHQ6IDEwcHg7DQogIG1hcmdpbi1yaWdodDogNXB4Ow0KICBib3JkZXI6IDFweCBzb2xpZCAjY2NjOw0KICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOw0KfQ0K"},{"version":3,"sources":["detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+ZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"detail.vue","sourceRoot":"src/pages/zixishi","sourcesContent":["<template>\r\n  <div style=\"width: 100%; min-height: 100vh; padding: 0 10px; boxSizing: border-box; background: #bfd2fc;\">\r\n    <div :style='{\"width\":\"100%\",\"padding\":\"20px\",\"margin\":\"10px auto\",\"borderRadius\":\"27px\",\"background\":\"#bfd2fc\"}' class=\"breadcrumb-preview\">\r\n      <el-breadcrumb :separator=\"'Ξ'\" :style='{\"fontSize\":\"14px\",\"lineHeight\":\"1\"}'>\r\n        <el-breadcrumb-item>首页</el-breadcrumb-item>\r\n        <el-breadcrumb-item v-for=\"(item, index) in breadcrumbItem\" :key=\"index\">{{item.name}}</el-breadcrumb-item>\r\n      </el-breadcrumb>\r\n    </div>\r\n\r\n    <div class=\"detail-preview\" :style='{\r\n      width: \"100%\",\r\n      margin: \"20px auto\",\r\n      position: \"relative\",\r\n      background: \"#fff\",\r\n      boxShadow: \"0px 4px 10px 0px rgba(0,0,0,0.302)\",\r\n      borderRadius: \"8px\",\r\n      boxSizing: \"border-box\",\r\n      padding: \"20px\"\r\n    }'>\r\n      <div class=\"attr\" :style=\"{\r\n        padding: '20px',\r\n        margin: '0',\r\n        color: '#000',\r\n        background: '#fff',\r\n        border: '0px solid #eee',\r\n        borderRadius: '4px',\r\n        textAlign: 'left',\r\n        boxShadow: '0 0 0px rgba(0,0,0,.1)'\r\n      }\">\r\n        <el-carousel :autoplay=\"false\" indicator-position=\"inside\" :style='{\"width\":\"100%\",\"margin\":\"0 0 10px\",\"border\":\"0px solid #ccc\"}'>\r\n          <el-carousel-item v-if=\"detail.tupian && detail.tupian.length > 0\" v-for=\"item in detail.tupian.split(',')\" :key=\"item\">\r\n            <el-image :style='{\"objectFit\":\"cover\",\"width\":\"100%\",\"height\":\"100%\"}' :src=\"item\" fit=\"cover\"></el-image>\r\n          </el-carousel-item>\r\n        </el-carousel>\r\n\r\n        <div class=\"attr-container\">\r\n          <h2 :style='{\"padding\":\"10px 0\",\"margin\":\"0 0 10px\",\"color\":\"#2e61e1\",\"textAlign\":\"center\",\"fontSize\":\"22px\"}' class=\"title\">{{ detail.mingcheng }}</h2>\r\n          <div :style='{\"padding\":\"10px 20px\",\"margin\":\"0 0 10px\",\"color\":\"#333\",\"background\":\"#eee\",\"fontSize\":\"14px\"}' class=\"attr-list\">\r\n            <div class=\"item\" :style='{\"padding\":\"0\",\"margin\":\"0 0 10px 0\",\"color\":\"#666\",\"display\":\"flex\",\"lineHeight\":\"24px\",\"fontSize\":\"14px\"}'>\r\n              <span class=\"label\" :style='{\"color\":\"#666\",\"width\":\"100px\",\"fontSize\":\"14px\",\"lineHeight\":\"30px\"}'>区域</span>\r\n              <span class=\"val\" :style='{\"flex\":1,\"fontSize\":\"14px\",\"lineHeight\":\"30px\"}'>{{ detail.quyu }}</span>\r\n            </div>\r\n            <div class=\"item\" :style='{\"padding\":\"0\",\"margin\":\"0 0 10px 0\",\"color\":\"#666\",\"display\":\"flex\",\"lineHeight\":\"24px\",\"fontSize\":\"14px\"}'>\r\n              <span class=\"label\" :style='{\"color\":\"#666\",\"width\":\"100px\",\"fontSize\":\"14px\",\"lineHeight\":\"30px\"}'>容纳人数</span>\r\n              <span class=\"val\" :style='{\"flex\":1,\"fontSize\":\"14px\",\"lineHeight\":\"30px\"}'>{{ detail.rongnarenshu }}</span>\r\n            </div>\r\n            <div class=\"item\" :style='{\"padding\":\"0\",\"margin\":\"0 0 10px 0\",\"color\":\"#666\",\"display\":\"flex\",\"lineHeight\":\"24px\",\"fontSize\":\"14px\"}'>\r\n              <span class=\"label\" :style='{\"color\":\"#666\",\"width\":\"100px\",\"fontSize\":\"14px\",\"lineHeight\":\"30px\"}'>开放时间</span>\r\n              <span class=\"val\" :style='{\"flex\":1,\"fontSize\":\"14px\",\"lineHeight\":\"30px\"}'>{{ detail.kaifangshijian }}</span>\r\n            </div>\r\n            <div class=\"item\" :style='{\"padding\":\"0\",\"margin\":\"0 0 10px 0\",\"color\":\"#666\",\"display\":\"flex\",\"lineHeight\":\"24px\",\"fontSize\":\"14px\"}'>\r\n              <span class=\"label\" :style='{\"color\":\"#666\",\"width\":\"100px\",\"fontSize\":\"14px\",\"lineHeight\":\"30px\"}'>楼层</span>\r\n              <span class=\"val\" :style='{\"flex\":1,\"fontSize\":\"14px\",\"lineHeight\":\"30px\"}'>{{ detail.louceng }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"seat-selection\" :style='{\"padding\":\"20px\",\"margin\":\"20px 0\",\"border\":\"1px solid #ccc\",\"borderRadius\":\"4px\",\"background\":\"#f9f9f9\"}'>\r\n          <h3 :style='{\"color\":\"#2e61e1\",\"margin-bottom\":\"15px\"}'>请选择座位</h3>\r\n          <div class=\"seat-map\" :style='{\"display\":\"grid\",\"grid-template-columns\":\"repeat(auto-fill, minmax(80px, 1fr))\",\"gap\":\"10px\",\"max-width\":\"700px\",\"margin\":\"0 auto\"}'>\r\n            <div\r\n                v-for=\"seatNum in totalSeats\"\r\n                :key=\"seatNum\"\r\n                :class=\"['seat-item', isSeatOccupied(seatNum) ? 'seat-occupied' : 'seat-available', {'seat-selected': selectedSeat === seatNum}]\"\r\n                @click=\"handleSeatClick(seatNum)\"\r\n                :style='{\"height\":\"80px\",\"lineHeight\":\"80px\",\"textAlign\":\"center\",\"fontSize\":\"14px\",\"borderRadius\":\"4px\",\"border\":\"1px solid #2e61e1\",\"transition\":\"all 0.3s\"}'\r\n            >\r\n              {{ seatNum }}\r\n            </div>\r\n          </div>\r\n          <p :style='{\"margin-top\":\"15px\",\"text-align\":\"center\",\"font-size\":\"12px\"}'>\r\n            <span :style='{\"display\":\"inline-block\",\"width\":\"15px\",\"height\":\"15px\",\"background\":\"#fff\",\"border\":\"1px solid #2e61e1\",\"margin-right\":\"5px\",\"vertical-align\":\"middle\"}'></span> 可选\r\n            <span :style='{\"display\":\"inline-block\",\"width\":\"15px\",\"height\":\"15px\",\"background\":\"#f8d7da\",\"border\":\"1px solid #ccc\",\"margin-left\":\"15px\",\"margin-right\":\"5px\",\"vertical-align\":\"middle\"}'></span> 已占\r\n            <span :style='{\"display\":\"inline-block\",\"width\":\"15px\",\"height\":\"15px\",\"background\":\"#e6f7ff\",\"border\":\"1px solid #1E4CD8\",\"boxShadow\":\"0 0 0 3px rgba(46, 97, 225, 0.3)\",\"margin-left\":\"15px\",\"margin-right\":\"5px\",\"vertical-align\":\"middle\"}'></span> 已选\r\n          </p>\r\n          <p v-if=\"selectedSeat\" :style='{\"margin-top\":\"15px\",\"font-weight\":\"bold\",\"text-align\":\"center\"}'>\r\n            您已选择座位号: {{ selectedSeat }}\r\n          </p>\r\n        </div>\r\n\r\n        <div class=\"bottom-buttons\" :style='{\"padding\":\"20px 0\",\"textAlign\":\"center\"}'>\r\n          <el-button\r\n              v-if=\"selectedSeat !== null\"\r\n              type=\"warning\"\r\n              @click=\"openTimeModal\"\r\n              :style='{\"border\":\"0\",\"cursor\":\"pointer\",\"padding\":\"0 24px\",\"margin\":\"0 10px\",\"outline\":\"none\",\"color\":\"#fff\",\"borderRadius\":\"4px\",\"background\":\"#FF9900\",\"width\":\"auto\",\"height\":\"40px\"}'\r\n          >\r\n            可约时间\r\n          </el-button>\r\n\r\n          <el-button\r\n              v-if=\"selectedSeat !== null\"\r\n              type=\"primary\"\r\n              @click=\"jumpToYuyue(selectedSeat)\"\r\n              :style='{\"border\":\"0\",\"cursor\":\"pointer\",\"padding\":\"0 24px\",\"margin\":\"0 10px\",\"outline\":\"none\",\"color\":\"#fff\",\"borderRadius\":\"4px\",\"background\":\"#2e61e1\",\"width\":\"auto\",\"height\":\"40px\"}'\r\n          >\r\n            在线预约\r\n          </el-button>\r\n        </div>\r\n\r\n        <div :style='{\"padding\":\"20px\",\"margin\":\"20px 0\",\"border\":\"1px solid #ccc\",\"borderRadius\":\"4px\",\"background\":\"#f9f9f9\"}'>\r\n          <h3 :style='{\"color\":\"#2e61e1\",\"margin-bottom\":\"15px\"}'>详情描述</h3>\r\n          <div v-html=\"detail.xiangqingmiaoshu\"></div>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <el-dialog\r\n        title=\"可约时间查询\"\r\n        :visible.sync=\"showTimeModal\"\r\n        width=\"800px\"\r\n    >\r\n      <div style=\"padding: 20px; font-size: 14px;\">\r\n        <h3 style=\"margin-bottom: 20px;\">\r\n          <span v-if=\"detail.mingcheng\">{{ detail.mingcheng }} - </span> 座位号: {{ selectedSeat }}\r\n        </h3>\r\n\r\n        <div style=\"margin-bottom: 20px; text-align: center;\">\r\n          <el-button\r\n              :type=\"availableDate === 'Today' ? 'primary' : 'default'\"\r\n              @click=\"changeAvailableDate('Today')\"\r\n              :disabled=\"!isTodayAvailable\"\r\n          >\r\n            今天 ({{ getDisplayDate('Today') }})\r\n          </el-button>\r\n          <el-button\r\n              :type=\"availableDate === 'Tomorrow' ? 'primary' : 'default'\"\r\n              @click=\"changeAvailableDate('Tomorrow')\"\r\n          >\r\n            明天 ({{ getDisplayDate('Tomorrow') }})\r\n          </el-button>\r\n        </div>\r\n\r\n        <div class=\"time-bar-container\">\r\n          <div class=\"time-bar-header\">\r\n                <span v-for=\"h in 14\" :key=\"'h'+h\" :style=\"{width: '7.14%'}\">\r\n                    {{ 7 + h }}:00\r\n                </span>\r\n          </div>\r\n\r\n          <div class=\"time-bar-body\">\r\n            <div\r\n                v-for=\"slot in timeBarSlots\"\r\n                :key=\"slot.start\"\r\n                :class=\"['time-slot', {'slot-booked': slot.isBooked, 'slot-free': !slot.isBooked}]\"\r\n                :title=\"slot.title\"\r\n            >\r\n            </div>\r\n          </div>\r\n\r\n          <div style=\"margin-top: 20px; text-align: center;\">\r\n            <span class=\"legend-item slot-free\"></span> <span>可约时段</span>\r\n            <span class=\"legend-item slot-booked\" style=\"margin-left: 15px;\"></span> <span>已被预约</span>\r\n            <div style=\"font-size: 12px; color: #999; margin-top: 10px;\">注意: 预约时间范围为 8:00 至 22:00。每个时间块代表一小时。</div>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      id: \"\",\r\n      detail: {},\r\n      swiper: {\r\n        indicator: 'inside',\r\n        autoplay: true,\r\n        delay: 5000,\r\n        initialSlide: 0,\r\n        effect: 'slide'\r\n      },\r\n      totalSeats: 0,\r\n      occupiedSeats: [],\r\n      selectedSeat: null, // 当前选中的座位号\r\n\r\n      // ******** 可约时间弹窗相关数据 ********\r\n      showTimeModal: false,\r\n      availableDate: 'Today', // 默认今天\r\n      bookedSlots: [], // 后端返回的已预约时段\r\n      timeBarSlots: [], // 用于渲染时间条的计算结果 (8:00-22:00)\r\n      // *******************************************\r\n    };\r\n  },\r\n  computed: {\r\n    // 面包屑\r\n    breadcrumbItem() {\r\n      return [\r\n        { name: '详情信息' }\r\n      ]\r\n    },\r\n    // 今天是否还有可预约的时间（当前时间在 22:00 前）\r\n    isTodayAvailable() {\r\n      const now = new Date();\r\n      // 22:00:00\r\n      const endHour = 22;\r\n      return now.getHours() < endHour;\r\n    }\r\n  },\r\n  methods: {\r\n    // 获取 0 填充的数字\r\n    getMakeZero(s) {\r\n      return s < 10 ? \"0\" + s : s;\r\n    },\r\n\r\n    // 获取指定日期字符串 (YYYY-MM-DD)\r\n    getDateString(day) {\r\n      const date = new Date();\r\n      if (day === 'Tomorrow') {\r\n        date.setDate(date.getDate() + 1);\r\n      }\r\n      const year = date.getFullYear();\r\n      const month = this.getMakeZero(date.getMonth() + 1);\r\n      const dayOfMonth = this.getMakeZero(date.getDate());\r\n      return `${year}-${month}-${dayOfMonth}`;\r\n    },\r\n\r\n    // 获取显示日期 (X月Y日)\r\n    getDisplayDate(day) {\r\n      const date = new Date();\r\n      if (day === 'Tomorrow') {\r\n        date.setDate(date.getDate() + 1);\r\n      }\r\n      return (date.getMonth() + 1) + '月' + date.getDate() + '日';\r\n    },\r\n\r\n    // 初始化详情数据\r\n    init() {\r\n      this.id = this.$route.query.id\r\n      this.$http({\r\n        url: `zixishi/detail/${this.id}`,\r\n        method: \"get\"\r\n      }).then(({ data }) => {\r\n        if (data && data.code === 0) {\r\n          this.detail = data.data;\r\n          this.totalSeats = this.detail.rongnarenshu ? parseInt(this.detail.rongnarenshu) : 0;\r\n          this.fetchOccupiedSeats();\r\n        } else {\r\n          this.$message.error(data.msg);\r\n        }\r\n      });\r\n    },\r\n\r\n    // 获取当前自习室所有已占用的座位列表\r\n    fetchOccupiedSeats() {\r\n      // 此方法暂时保持为空，因为主要校验在弹窗和预约提交时进行\r\n    },\r\n\r\n    // 判断座位是否已占用\r\n    isSeatOccupied(seatNum) {\r\n      return this.occupiedSeats.includes(seatNum);\r\n    },\r\n\r\n    // 处理座位点击事件\r\n    handleSeatClick(seatNum) {\r\n      if (this.isSeatOccupied(seatNum)) {\r\n        this.$message.warning(\"该座位已被占用，请选择其他座位\");\r\n        this.selectedSeat = null;\r\n        return;\r\n      }\r\n      // 切换选中状态\r\n      this.selectedSeat = this.selectedSeat === seatNum ? null : seatNum;\r\n    },\r\n\r\n    // 跳转到预约页面\r\n    jumpToYuyue(seatNum) {\r\n      if (!seatNum) {\r\n        this.$message.error(\"请先选择一个座位\");\r\n        return;\r\n      }\r\n      // 将自习室ID、名称和座位号传递给预约页面\r\n      localStorage.setItem(\"crossObj\", JSON.stringify({\r\n        id: this.detail.id,\r\n        mingcheng: this.detail.mingcheng,\r\n        zuowei: seatNum\r\n      }));\r\n      // 注意：这里跳转的路径确保和您项目中的路径一致\r\n      this.$router.push({ path: '/index/yuyuexinxiAdd', query: { type: 'cross' } });\r\n    },\r\n\r\n    // ******** 新增：可约时间弹窗相关方法 ********\r\n    openTimeModal() {\r\n      if (!this.selectedSeat) {\r\n        this.$message.error('请先选择一个座位');\r\n        return;\r\n      }\r\n      this.showTimeModal = true;\r\n\r\n      // 确保默认选中仍然可预约的日期\r\n      if (this.availableDate === 'Today' && !this.isTodayAvailable) {\r\n        this.availableDate = 'Tomorrow';\r\n      }\r\n\r\n      this.changeAvailableDate(this.availableDate); // 默认加载数据\r\n    },\r\n\r\n    changeAvailableDate(day) {\r\n      if (day === 'Today' && !this.isTodayAvailable) {\r\n        this.$message.warning(\"今天已过预约截止时间 22:00，请查看明天的时间。\");\r\n        return;\r\n      }\r\n      this.availableDate = day;\r\n      this.fetchBookedSlots(day);\r\n    },\r\n\r\n    // 调用后端接口，获取指定日期、指定座位的已预约时段\r\n    fetchBookedSlots(day) {\r\n      if (!this.detail.id || !this.selectedSeat) return;\r\n\r\n      const dateString = this.getDateString(day);\r\n\r\n      this.$http.get('yuyuexinxi/seat/list', {\r\n        params: {\r\n          zixishiid: this.detail.id,\r\n          zuowei: this.selectedSeat,\r\n          date: dateString // 传递日期参数\r\n        }\r\n      }).then(res => {\r\n        if (res.data.code === 0) {\r\n          this.bookedSlots = res.data.data || [];\r\n          // 计算可约时段\r\n          this.timeBarSlots = this.calculateAvailableSlots(this.bookedSlots, dateString, day === 'Today');\r\n        } else {\r\n          this.$message.error('获取预约时段失败: ' + res.data.msg);\r\n          this.bookedSlots = [];\r\n          this.timeBarSlots = this.calculateAvailableSlots([], dateString, day === 'Today');\r\n        }\r\n      }).catch(err => {\r\n        console.error(err);\r\n        this.$message.error('网络错误，无法获取可约时间。');\r\n        this.bookedSlots = [];\r\n        this.timeBarSlots = this.calculateAvailableSlots([], dateString, day === 'Today');\r\n      });\r\n    },\r\n\r\n    // 核心逻辑：将已预约时段转换为 8:00-22:00 的时间条数据\r\n    calculateAvailableSlots(bookedList, dateString, isToday) {\r\n      // 定义 8:00 到 22:00 的 14 个一小时时段\r\n      const timeSlots = [];\r\n      const NOW = new Date();\r\n\r\n      for (let h = 8; h < 22; h++) {\r\n        const slot = {\r\n          start: h, // 8, 9, 10, ... 21\r\n          end: h + 1, // 9, 10, 11, ... 22\r\n          isBooked: false,\r\n          title: `${this.getMakeZero(h)}:00 - ${this.getMakeZero(h + 1)}:00`\r\n        };\r\n\r\n        // 针对今天，禁用当前时间之前的时段（以小时为粒度）\r\n        if (isToday) {\r\n          // 当前槽位的结束时间（小时）\r\n          if (h + 1 <= NOW.getHours()) {\r\n            slot.isBooked = true; // 视为已过期/不可约\r\n            slot.title += ' (已过期/不可约)';\r\n          }\r\n        }\r\n\r\n        // 针对今天，如果当前时间超过 22:00，则所有时段都标记为不可约（虽然 isTodayAvailable 已经禁用按钮，但这是防范）\r\n        if (isToday && NOW.getHours() >= 22) {\r\n          slot.isBooked = true;\r\n          slot.title += ' (今天已过预约时间)';\r\n        }\r\n\r\n        timeSlots.push(slot);\r\n      }\r\n\r\n      // 标记已被预约的时段\r\n      bookedList.forEach(booked => {\r\n        const currentDay = dateString;\r\n\r\n        // 注意： booked.yuyueStart/yuyueEnd 是后端返回的完整时间戳/时间字符串\r\n        const bookedStartTime = new Date(booked.yuyueStart).getTime();\r\n        const bookedEndTime = new Date(booked.yuyueEnd).getTime();\r\n\r\n        // 遍历每个一小时的槽位，检查是否与预约时间冲突\r\n        for (let i = 0; i < timeSlots.length; i++) {\r\n          const slot = timeSlots[i];\r\n\r\n          // 跳过已标记为不可约的（如已过期/已过时间）\r\n          if (slot.isBooked && (slot.title.includes('(已过期/不可约)') || slot.title.includes('(今天已过预约时间)'))) {\r\n            continue;\r\n          }\r\n\r\n          // 计算当前槽位在当前日期下的时间戳\r\n          // 槽位时间范围是 [slotStartTime, slotEndTime)\r\n          const slotStartTime = new Date(`${currentDay} ${this.getMakeZero(slot.start)}:00:00`).getTime();\r\n          const slotEndTime = new Date(`${currentDay} ${this.getMakeZero(slot.end)}:00:00`).getTime();\r\n\r\n          // 检查两个时间段 [A, B) 和 [C, D) 是否重叠： A < D 且 C < B\r\n          if (bookedStartTime < slotEndTime && slotStartTime < bookedEndTime) {\r\n            slot.isBooked = true;\r\n            // 如果已经标记为已预约，则不重复添加 title\r\n            if (!slot.title.includes('(已被预约)')) {\r\n              slot.title += ` (已被预约)`;\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n      return timeSlots;\r\n    },\r\n    // *******************************************\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  }\r\n};\r\n</script>\r\n\r\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\r\n// 面包屑样式\r\n.breadcrumb-preview {\r\n  ::v-deep .el-breadcrumb__separator {\r\n    margin: 0 5px;\r\n    color: #666;\r\n    font-weight: 500;\r\n  }\r\n  ::v-deep .el-breadcrumb__inner a {\r\n    color: #666;\r\n    display: inline-block;\r\n  }\r\n  ::v-deep .el-breadcrumb__inner {\r\n    color: #666;\r\n    display: inline-block;\r\n  }\r\n}\r\n\r\n// 轮播图样式\r\n.el-carousel >>> .el-carousel__indicator button {\r\n  width: 10px;\r\n  height: 10px;\r\n  border-radius: 10px;\r\n  background: rgba(255,255,255,0.5);\r\n  margin: 0 4px;\r\n}\r\n.el-carousel >>> .el-carousel__indicators li.is-active {\r\n  width: 20px;\r\n  border-radius: 4px;\r\n  background: #fff;\r\n}\r\n\r\n// 座位样式优化\r\n.seat-item {\r\n  // 可选座位悬停效果\r\n  &.seat-available:not(.seat-selected):hover {\r\n    transform: scale(1.05);\r\n    box-shadow: 0 4px 8px rgba(46, 97, 225, 0.15);\r\n    border-color: #1E4CD8 !important;\r\n    cursor: pointer;\r\n  }\r\n\r\n  // 已选座位动画效果\r\n  &.seat-selected {\r\n    box-shadow: 0 0 0 3px rgba(46, 97, 225, 0.3);\r\n    animation: pulse 1.5s infinite;\r\n    background: #e6f7ff; /* 浅蓝色背景 */\r\n  }\r\n\r\n  // 已占用座位样式强化\r\n  &.seat-occupied {\r\n    background: #f8d7da; /* 浅红色背景 */\r\n    cursor: not-allowed;\r\n    opacity: 0.8;\r\n  }\r\n}\r\n\r\n// 脉冲动画\r\n@keyframes pulse {\r\n  0% {\r\n    box-shadow: 0 0 0 0 rgba(46, 97, 225, 0.4);\r\n  }\r\n  70% {\r\n    box-shadow: 0 0 0 6px rgba(46, 97, 225, 0);\r\n  }\r\n  100% {\r\n    box-shadow: 0 0 0 0 rgba(46, 97, 225, 0);\r\n  }\r\n}\r\n\r\n// ******** 新增：时间条样式 ********\r\n.time-bar-container {\r\n  border: 1px solid #ddd;\r\n  padding: 10px;\r\n  border-radius: 4px;\r\n  max-width: 760px; /* 限制宽度 */\r\n  margin: 0 auto;\r\n}\r\n.time-bar-header {\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  font-size: 10px;\r\n  color: #666;\r\n  margin-bottom: 5px;\r\n  padding-left: 1px; /* 对齐第一个时间刻度 */\r\n}\r\n.time-bar-header span {\r\n  text-align: left;\r\n  white-space: nowrap;\r\n  position: relative;\r\n}\r\n.time-bar-header span:first-child::before {\r\n  content: '';\r\n  position: absolute;\r\n  left: 0;\r\n  top: -5px;\r\n  height: 10px;\r\n  border-left: 1px solid #ccc;\r\n}\r\n.time-bar-header span::after {\r\n  content: '';\r\n  position: absolute;\r\n  right: 0;\r\n  top: -5px;\r\n  height: 10px;\r\n  border-left: 1px solid #ccc;\r\n}\r\n\r\n.time-bar-body {\r\n  display: flex;\r\n  height: 40px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n  overflow: hidden;\r\n  box-sizing: content-box;\r\n}\r\n.time-slot {\r\n  width: 7.142857%; /* 100% / 14 slots (8:00-22:00) */\r\n  height: 100%;\r\n  cursor: default;\r\n  box-sizing: border-box;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.slot-free {\r\n  background-color: #d4edda; /* Light green */\r\n  border-right: 1px dashed #888;\r\n}\r\n.slot-booked {\r\n  background-color: #f8d7da; /* Light red */\r\n  border-right: 1px solid #888;\r\n  cursor: not-allowed;\r\n}\r\n.legend-item {\r\n  display: inline-block;\r\n  width: 20px;\r\n  height: 10px;\r\n  margin-right: 5px;\r\n  border: 1px solid #ccc;\r\n  vertical-align: middle;\r\n}\r\n</style>"]}]}