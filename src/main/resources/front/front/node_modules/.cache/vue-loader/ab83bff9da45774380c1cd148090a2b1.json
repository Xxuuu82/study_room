{"remainingRequest":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\src\\pages\\register\\register.vue?vue&type=style&index=0&id=2d48598a&rel=stylesheet%2Fscss&lang=scss&scoped=true&","dependencies":[{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\src\\pages\\register\\register.vue","mtime":1765972541980},{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1765241852000},{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\NBU\\junior\\1\\software engineering\\study_room\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmNvbnRhaW5lciB7DQogIC5lbC1kYXRlLWVkaXRvci5lbC1pbnB1dCB7DQogICAgd2lkdGg6IDEwMCU7DQogIH0NCg0KICAucmdzLWZvcm0gLmVsLWlucHV0ID4+PiAuZWwtaW5wdXRfX2lubmVyIHsNCiAgICBib3JkZXI6IDA7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIHBhZGRpbmc6IDAgMTBweDsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIGNvbG9yOiAjMDAwOw0KICAgIGJhY2tncm91bmQ6ICNGOUY5Rjk7DQogICAgd2lkdGg6IDEwMCU7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGhlaWdodDogNDRweDsNCiAgfQ0KDQogIC5yZ3MtZm9ybSAuZWwtc2VsZWN0ID4+PiAuZWwtaW5wdXRfX2lubmVyIHsNCiAgICBib3JkZXI6IDA7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIHBhZGRpbmc6IDAgMTBweDsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIGNvbG9yOiAjMDAwOw0KICAgIGJhY2tncm91bmQ6ICNGOUY5Rjk7DQogICAgd2lkdGg6IDEwMCU7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGhlaWdodDogNDRweDsNCiAgfQ0KDQogIC5yZ3MtZm9ybSAuZWwtZGF0ZS1lZGl0b3IgPj4+IC5lbC1pbnB1dF9faW5uZXIgew0KICAgIGJvcmRlcjogMDsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgcGFkZGluZzogMCAxMHB4IDAgMzBweDsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIGNvbG9yOiAjMDAwOw0KICAgIGJhY2tncm91bmQ6ICNGOUY5Rjk7DQogICAgd2lkdGg6IDEwMCU7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGhlaWdodDogNDRweDsNCiAgfQ0KDQogIC5yZ3MtZm9ybSA+Pj4gLmVsLXVwbG9hZC0tcGljdHVyZS1jYXJkIHsNCiAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsNCiAgICBib3JkZXI6IDA7DQogICAgYm9yZGVyLXJhZGl1czogMDsNCiAgICB3aWR0aDogYXV0bzsNCiAgICBoZWlnaHQ6IGF1dG87DQogICAgbGluZS1oZWlnaHQ6IGluaXRpYWw7DQogICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsNCiAgfQ0KDQogIC8qIHJlcXVpcmVkIOagh+ivhu+8mkVsZW1lbnQgVUkg5Zyo5b+F5aGr5pe25Lya57uZIGVsLWZvcm0taXRlbSDliqAgaXMtcmVxdWlyZWQg57G777yM5LiL6Z2i6K6p5qCH562+5pi+56S657qi5pifICovDQogIC5lbC1mb3JtLWl0ZW0uaXMtcmVxdWlyZWQgLmVsLWZvcm0taXRlbV9fbGFiZWw6OmFmdGVyIHsNCiAgICBjb250ZW50OiAiICoiOw0KICAgIGNvbG9yOiAjZjU2YzZjOw0KICAgIG1hcmdpbi1sZWZ0OiA0cHg7DQogIH0NCg0KICAucmdzLWZvcm0gPj4+IC51cGxvYWQgLnVwbG9hZC1pbWcgew0KICAgIGJvcmRlcjogMXB4IGRhc2hlZCAjODg4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgY29sb3I6ICM4ODg7DQogICAgd2lkdGg6IDEwMHB4Ow0KICAgIGZvbnQtc2l6ZTogMzJweDsNCiAgICBsaW5lLWhlaWdodDogMTAwcHg7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGhlaWdodDogMTAwcHg7DQogIH0NCg0KICAucmdzLWZvcm0gPj4+IC5lbC11cGxvYWQtbGlzdCAuZWwtdXBsb2FkLWxpc3RfX2l0ZW0gew0KICAgIGJvcmRlcjogMXB4IGRhc2hlZCAjODg4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgY29sb3I6ICM4ODg7DQogICAgd2lkdGg6IDEwMHB4Ow0KICAgIGZvbnQtc2l6ZTogMzJweDsNCiAgICBsaW5lLWhlaWdodDogMTAwcHg7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGhlaWdodDogMTAwcHg7DQogIH0NCg0KICAucmdzLWZvcm0gPj4+IC5lbC11cGxvYWQgLmVsLWljb24tcGx1cyB7DQogICAgYm9yZGVyOiAxcHggZGFzaGVkICM4ODg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBjb2xvcjogIzg4ODsNCiAgICB3aWR0aDogMTAwcHg7DQogICAgZm9udC1zaXplOiAzMnB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxMDBweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgaGVpZ2h0OiAxMDBweDsNCiAgfQ0KfQ0K"},{"version":3,"sources":["register.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkPA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"register.vue","sourceRoot":"src/pages/register","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"container\" :style=\"{\r\n        minHeight: '100vh',\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        background: '#f3f7fa',\r\n        width: '100%'\r\n      }\">\r\n      <el-form class=\"rgs-form\" v-if=\"pageFlag === 'register'\"\r\n               :style=\"{\r\n                 padding: '20px',\r\n                 boxShadow: '0px 4px 10px 0px rgba(0,0,0,0.302)',\r\n                 borderRadius: '10px',\r\n                 background: '#fff',\r\n                 width: '420px',\r\n                 height: 'auto'\r\n               }\"\r\n               ref=\"registerForm\"\r\n               :model=\"registerForm\"\r\n               :rules=\"rules\"\r\n               label-position=\"top\"\r\n      >\r\n        <!-- 标题 -->\r\n        <div :style=\"{\r\n            width: '100%',\r\n            margin: '0 0 16px 0',\r\n            lineHeight: '44px',\r\n            fontSize: '20px',\r\n            color: '#000',\r\n            textAlign: 'center',\r\n            fontWeight: '700'\r\n          }\">智慧自习室预约系统 注册</div>\r\n\r\n        <!-- 学号 -->\r\n        <el-form-item prop=\"xuehao\" label=\"学号\">\r\n          <el-input v-model=\"registerForm.xuehao\" placeholder=\"请输入学号\"></el-input>\r\n        </el-form-item>\r\n\r\n        <!-- 密码 -->\r\n        <el-form-item prop=\"mima\" label=\"密码\">\r\n          <el-input v-model=\"registerForm.mima\" type=\"password\" placeholder=\"请输入密码\"></el-input>\r\n        </el-form-item>\r\n\r\n        <!-- 确认密码 -->\r\n        <el-form-item prop=\"mima2\" label=\"确认密码\">\r\n          <el-input v-model=\"registerForm.mima2\" type=\"password\" placeholder=\"请再次输入密码\"></el-input>\r\n        </el-form-item>\r\n\r\n        <!-- 姓名 -->\r\n        <el-form-item prop=\"xingming\" label=\"姓名\">\r\n          <el-input v-model=\"registerForm.xingming\" placeholder=\"请输入姓名\"></el-input>\r\n        </el-form-item>\r\n\r\n        <!-- 性别 -->\r\n        <el-form-item prop=\"xingbie\" label=\"性别\">\r\n          <el-select v-model=\"registerForm.xingbie\" placeholder=\"请选择性别\">\r\n            <el-option v-for=\"(item, index) in xueshengxingbieOptions\" :key=\"index\" :label=\"item\" :value=\"item\" />\r\n          </el-select>\r\n        </el-form-item>\r\n\r\n        <!-- 头像上传（复用项目已有 file-upload 组件） -->\r\n        <el-form-item prop=\"touxiang\" label=\"头像\">\r\n          <file-upload\r\n              tip=\"点击上传头像\"\r\n              action=\"file/upload\"\r\n              :limit=\"1\"\r\n              :multiple=\"false\"\r\n              :fileUrls=\"registerForm.touxiang ? registerForm.touxiang : ''\"\r\n              @change=\"xueshengtouxiangUploadChange\"\r\n          ></file-upload>\r\n        </el-form-item>\r\n\r\n        <!-- 手机 -->\r\n        <el-form-item prop=\"shouji\" label=\"手机\">\r\n          <el-input v-model=\"registerForm.shouji\" placeholder=\"请输入手机\"></el-input>\r\n        </el-form-item>\r\n\r\n        <!-- 班级 -->\r\n        <el-form-item prop=\"banji\" label=\"班级\">\r\n          <el-input v-model=\"registerForm.banji\" placeholder=\"请输入班级\"></el-input>\r\n        </el-form-item>\r\n\r\n        <!-- 按钮组 -->\r\n        <div style=\"width:100%; display:flex; flex-direction:column; align-items:center; gap:12px; margin-top:12px;\">\r\n          <el-button type=\"primary\" :style=\"submitBtnStyle\" @click=\"submitForm('registerForm')\">注册</el-button>\r\n          <el-button type=\"default\" :style=\"resetBtnStyle\" @click=\"resetForm('registerForm')\">重置</el-button>\r\n          <router-link :to=\"{ path: '/login' }\" style=\"color:#999; margin-top:8px; display:block;\">已有账户登录</router-link>\r\n        </div>\r\n      </el-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      pageFlag: '',\r\n      tableName: '',\r\n      registerForm: {\r\n        xuehao: '',\r\n        mima: '',\r\n        mima2: '',\r\n        xingming: '',\r\n        xingbie: '',\r\n        touxiang: '',\r\n        shouji: '',\r\n        banji: ''\r\n      },\r\n      xueshengxingbieOptions: ['男', '女'],\r\n      rules: {\r\n        xuehao: [\r\n          { required: true, message: '请输入学号', trigger: 'blur' }\r\n        ],\r\n        mima: [\r\n          { required: true, message: '请输入密码', trigger: 'blur' },\r\n          { min: 6, message: '密码长度不能少于6位', trigger: 'blur' }\r\n        ],\r\n        mima2: [\r\n          { required: true, message: '请确认密码', trigger: 'blur' },\r\n          { validator: (rule, value, callback) => {\r\n              if (value !== this.registerForm.mima) {\r\n                callback(new Error('两次密码输入不一致'));\r\n              } else {\r\n                callback();\r\n              }\r\n            }, trigger: 'blur'\r\n          }\r\n        ],\r\n        xingming: [\r\n          { required: true, message: '请输入姓名', trigger: 'blur' }\r\n        ],\r\n        shouji: [\r\n          { required: true, validator: (rule, value, callback) => {\r\n              if (!value) return callback(new Error('请输入手机号'));\r\n              const mobileReg = /^1[3-9]\\d{9}$/;\r\n              if (!mobileReg.test(value)) return callback(new Error('请输入正确的手机号码'));\r\n              callback();\r\n            }, trigger: 'blur' }\r\n        ]\r\n      },\r\n      submitBtnStyle: {\r\n        border: '0',\r\n        cursor: 'pointer',\r\n        padding: '0 10px',\r\n        outline: 'none',\r\n        color: '#fff',\r\n        borderRadius: '8px',\r\n        background: '#78ABC3',\r\n        display: 'block',\r\n        width: '80%',\r\n        fontSize: '16px',\r\n        height: '44px'\r\n      },\r\n      resetBtnStyle: {\r\n        border: '0',\r\n        cursor: 'pointer',\r\n        padding: '0 10px',\r\n        outline: 'none',\r\n        color: '#fff',\r\n        borderRadius: '8px',\r\n        background: '#B0C9CF',\r\n        display: 'block',\r\n        width: '80%',\r\n        fontSize: '16px',\r\n        height: '44px'\r\n      }\r\n    };\r\n  },\r\n  created() {\r\n    this.pageFlag = this.$route.query.pageFlag || 'register';\r\n    this.tableName = this.$route.query.role || 'xuesheng';\r\n    // keep rules in data; already defined\r\n  },\r\n  methods: {\r\n    getUUID() {\r\n      return new Date().getTime();\r\n    },\r\n    xueshengtouxiangUploadChange(fileUrls) {\r\n      // file-upload 组件可能返回完整 URL，我们保存数据库相对路径（去掉 baseUrl）\r\n      if (!fileUrls) {\r\n        this.registerForm.touxiang = '';\r\n        return;\r\n      }\r\n      this.registerForm.touxiang = fileUrls.replace(new RegExp(this.$config.baseUrl, 'g'), '');\r\n    },\r\n    submitForm(formName) {\r\n      this.$refs[formName].validate(valid => {\r\n        if (valid) {\r\n          // 两次密码一致校验（表单验证中也有，但此处再做一次保险）\r\n          if (this.registerForm.mima !== this.registerForm.mima2) {\r\n            this.$message.error('两次密码输入不一致');\r\n            return;\r\n          }\r\n\r\n          const url = `${this.tableName}/register`;\r\n\r\n          // 关键：使用 emulateJSON:true 强制以 application/x-www-form-urlencoded 发送，避免服务器 415\r\n          this.$http.post(url, this.registerForm, { emulateJSON: true })\r\n              .then(res => {\r\n                if (res.data && res.data.code === 0) {\r\n                  this.$message({\r\n                    message: '注册成功',\r\n                    type: 'success',\r\n                    duration: 1500,\r\n                    onClose: () => {\r\n                      this.$router.push('/login');\r\n                    }\r\n                  });\r\n                } else {\r\n                  // 后端可能返回 401/415/其他，统一展示后端 msg\r\n                  this.$message.error(res.data?.msg || '注册失败');\r\n                }\r\n              })\r\n              .catch(err => {\r\n                // 如果后端返回 415 等错误，给出清晰提示\r\n                console.error('注册请求失败：', err);\r\n                const status = (err && err.status) || (err && err.response && err.response.status) || null;\r\n                if (status === 415) {\r\n                  this.$message.error('请求格式不被后端接受 (415)。已尝试以表单格式提交，请检查后端register接口是否允许 POST 表单或是否需要登录。');\r\n                } else if (status === 401) {\r\n                  this.$message.error('需要先登录或权限校验未通过（401）');\r\n                } else {\r\n                  this.$message.error('网络请求失败，请检查后端服务或网络连接');\r\n                }\r\n              });\r\n        } else {\r\n          // 表单验证未通过，会显示对应校验信息\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    resetForm(formName) {\r\n      if (this.$refs[formName]) this.$refs[formName].resetFields();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\r\n.container {\r\n  .el-date-editor.el-input {\r\n    width: 100%;\r\n  }\r\n\r\n  .rgs-form .el-input >>> .el-input__inner {\r\n    border: 0;\r\n    border-radius: 8px;\r\n    padding: 0 10px;\r\n    outline: none;\r\n    color: #000;\r\n    background: #F9F9F9;\r\n    width: 100%;\r\n    font-size: 14px;\r\n    height: 44px;\r\n  }\r\n\r\n  .rgs-form .el-select >>> .el-input__inner {\r\n    border: 0;\r\n    border-radius: 8px;\r\n    padding: 0 10px;\r\n    outline: none;\r\n    color: #000;\r\n    background: #F9F9F9;\r\n    width: 100%;\r\n    font-size: 14px;\r\n    height: 44px;\r\n  }\r\n\r\n  .rgs-form .el-date-editor >>> .el-input__inner {\r\n    border: 0;\r\n    border-radius: 8px;\r\n    padding: 0 10px 0 30px;\r\n    outline: none;\r\n    color: #000;\r\n    background: #F9F9F9;\r\n    width: 100%;\r\n    font-size: 14px;\r\n    height: 44px;\r\n  }\r\n\r\n  .rgs-form >>> .el-upload--picture-card {\r\n    background: transparent;\r\n    border: 0;\r\n    border-radius: 0;\r\n    width: auto;\r\n    height: auto;\r\n    line-height: initial;\r\n    vertical-align: middle;\r\n  }\r\n\r\n  /* required 标识：Element UI 在必填时会给 el-form-item 加 is-required 类，下面让标签显示红星 */\r\n  .el-form-item.is-required .el-form-item__label::after {\r\n    content: \" *\";\r\n    color: #f56c6c;\r\n    margin-left: 4px;\r\n  }\r\n\r\n  .rgs-form >>> .upload .upload-img {\r\n    border: 1px dashed #888;\r\n    cursor: pointer;\r\n    border-radius: 8px;\r\n    color: #888;\r\n    width: 100px;\r\n    font-size: 32px;\r\n    line-height: 100px;\r\n    text-align: center;\r\n    height: 100px;\r\n  }\r\n\r\n  .rgs-form >>> .el-upload-list .el-upload-list__item {\r\n    border: 1px dashed #888;\r\n    cursor: pointer;\r\n    border-radius: 8px;\r\n    color: #888;\r\n    width: 100px;\r\n    font-size: 32px;\r\n    line-height: 100px;\r\n    text-align: center;\r\n    height: 100px;\r\n  }\r\n\r\n  .rgs-form >>> .el-upload .el-icon-plus {\r\n    border: 1px dashed #888;\r\n    cursor: pointer;\r\n    border-radius: 8px;\r\n    color: #888;\r\n    width: 100px;\r\n    font-size: 32px;\r\n    line-height: 100px;\r\n    text-align: center;\r\n    height: 100px;\r\n  }\r\n}\r\n</style>"]}]}