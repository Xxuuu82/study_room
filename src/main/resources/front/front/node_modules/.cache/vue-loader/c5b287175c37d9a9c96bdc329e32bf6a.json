{"remainingRequest":"D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\src\\pages\\zixishi\\add.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\src\\pages\\zixishi\\add.vue","mtime":1765974852890},{"path":"D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\3\\软件工程\\项目\\study_room\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGlkOiAnJywNCiAgICAgIGJhc2VVcmw6ICcnLA0KICAgICAgcm86ew0KICAgICAgICBtaW5nY2hlbmcgOiBmYWxzZSwNCiAgICAgICAgdHVwaWFuIDogZmFsc2UsDQogICAgICAgIGd1aW1vIDogZmFsc2UsDQogICAgICAgIHp1b3dlaSA6IGZhbHNlLA0KICAgICAgICB3ZWl6aGkgOiBmYWxzZSwNCiAgICAgICAgc2hlc2hpIDogZmFsc2UsDQogICAgICAgIGtleXVlc2hpamlhbiA6IGZhbHNlLA0KICAgICAgICBzaGlmb3V5b3VrZSA6IGZhbHNlLA0KICAgICAgICB4aWFuZ3FpbmcgOiBmYWxzZSwNCiAgICAgIH0sDQogICAgICB0eXBlOiAnJywNCiAgICAgIHVzZXJUYWJsZU5hbWU6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdVc2VyVGFibGVOYW1lJykgfHwgJ3h1ZXNoZW5nJywNCiAgICAgIHJ1bGVGb3JtOiB7DQogICAgICAgIG1pbmdjaGVuZzogJycsDQogICAgICAgIHR1cGlhbjogJycsDQogICAgICAgIGd1aW1vOiAnJywNCiAgICAgICAgenVvd2VpOiAnMjAnLA0KICAgICAgICB3ZWl6aGk6ICcnLA0KICAgICAgICBzaGVzaGk6ICcnLA0KICAgICAgICBrZXl1ZXNoaWppYW46ICcnLA0KICAgICAgICBzaGlmb3V5b3VrZTogJ+aYrycsDQogICAgICAgIHhpYW5ncWluZzogJycsDQogICAgICB9LA0KICAgICAgZ3VpbW9PcHRpb25zOiBbXSwNCiAgICAgIHNoaWZvdXlvdWtlT3B0aW9uczogW10sDQogICAgICBydWxlczogew0KICAgICAgICBtaW5nY2hlbmc6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn5ZCN56ew5LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH1dLA0KICAgICAgICB6dW93ZWk6IFt7IHZhbGlkYXRvcjogdGhpcy4kdmFsaWRhdGUgPyB0aGlzLiR2YWxpZGF0ZS5pc0ludE51bWVyIDogKCkgPT4gdHJ1ZSwgdHJpZ2dlcjogJ2JsdXInIH1dLA0KICAgICAgICB3ZWl6aGk6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn5L2N572u5LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH1dLA0KICAgICAgfSwNCg0KICAgICAgLy8gYXBwb2ludG1lbnQgY29udHJvbHMNCiAgICAgIHN0YXJ0RGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNsaWNlKDAsMTApLA0KICAgICAgc3RhcnRUaW1lOiAnJywgLy8gJ0hIOm1tJw0KICAgICAgZW5kVGltZTogJycsDQoNCiAgICAgIC8vIHJlYWN0aXZlIGVhcmxpZXN0IHN0YXJ0IGNvbXB1dGVkIGZyb20gYnJvd3NlciB0aW1lOyByZWZyZXNoIG9uIGZvY3VzIG9yIGRhdGUgY2hhbmdlDQogICAgICBlYXJsaWVzdFN0YXJ0Rm9yUGlja2VyOiAnJywNCg0KICAgICAgc2Vzc2lvblVzZXI6IHt9DQogICAgfTsNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICB0aW1lU3RhcnRPcHRpb25zKCkgew0KICAgICAgbGV0IG9wZW5TdGFydCA9ICcwODowMCc7DQogICAgICBjb25zdCBsYXN0U3RhcnQgPSAnMjE6MzAnOw0KDQogICAgICAvLyDlpoLmnpzpgInmi6nnmoTmmK/ku4rlpKkNCiAgICAgIGlmICh0aGlzLnN0YXJ0RGF0ZSA9PT0gdGhpcy5fdG9kYXlTdHIoKSkgew0KICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOw0KICAgICAgICBjb25zdCByb3VuZGVkTm93ID0gdGhpcy5fcm91bmRVcFRvMzAobm93KTsNCiAgICAgICAgY29uc3QgbWluQXZhaWxhYmxlID0gdGhpcy5fdGltZVN0ckZyb21EYXRlKHJvdW5kZWROb3cpOw0KDQogICAgICAgIC8vIOWmguaenOW9k+WJjeaXtumXtOW3sue7j+i/h+S6hiAyMTozMO+8jOWImeS7iuWkqeaXoOazlemihOe6pg0KICAgICAgICBpZiAodGhpcy5fdGltZVN0clRvTWludXRlcyhtaW5BdmFpbGFibGUpID4gdGhpcy5fdGltZVN0clRvTWludXRlcyhsYXN0U3RhcnQpKSB7DQogICAgICAgICAgb3BlblN0YXJ0ID0gJzIzOjU5JzsgLy8g5L2/5b6X5YiX6KGo5Li656m6DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgLy8g5Y+WIDA4OjAwIOWSjOW9k+WJjeWPluaVtOaXtumXtOS4reeahOi+g+Wkp+iAhQ0KICAgICAgICAgIG9wZW5TdGFydCA9IHRoaXMuX3RpbWVTdHJUb01pbnV0ZXMobWluQXZhaWxhYmxlKSA+IHRoaXMuX3RpbWVTdHJUb01pbnV0ZXMob3BlblN0YXJ0KQ0KICAgICAgICAgICAgICA/IG1pbkF2YWlsYWJsZSA6IG9wZW5TdGFydDsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgcmV0dXJuIHsgc3RhcnQ6IG9wZW5TdGFydCwgc3RlcDogJzAwOjMwJywgZW5kOiBsYXN0U3RhcnQgfTsNCiAgICB9LA0KDQogICAgdGltZUVuZE9wdGlvbnMoKSB7DQogICAgICBjb25zdCBvcGVuRW5kID0gJzIyOjAwJzsNCiAgICAgIC8vIOe7k+adn+aXtumXtOiHs+WwkeavlOW8gOWni+aXtumXtOaZmiAzMCDliIbpkp8NCiAgICAgIGNvbnN0IHN0YXJ0TGltaXQgPSB0aGlzLnN0YXJ0VGltZSA/IHRoaXMuX2FkZE1pbnV0ZXNUb1RpbWVTdHIodGhpcy5zdGFydFRpbWUsIDMwKSA6ICcwODozMCc7DQogICAgICByZXR1cm4gew0KICAgICAgICBzdGFydDogc3RhcnRMaW1pdCwNCiAgICAgICAgc3RlcDogJzAwOjMwJywNCiAgICAgICAgZW5kOiBvcGVuRW5kLA0KICAgICAgICBtaW5UaW1lOiB0aGlzLnN0YXJ0VGltZQ0KICAgICAgfTsNCiAgICB9DQogIH0sDQoNCiAgICB0aW1lRW5kT3B0aW9ucygpIHsNCiAgICAgIGNvbnN0IG9wZW5FbmQgPSAnMjI6MDAnOw0KICAgICAgaWYgKHRoaXMuc3RhcnRUaW1lKSB7DQogICAgICAgIGNvbnN0IHMgPSB0aGlzLl9hZGRNaW51dGVzVG9UaW1lU3RyKHRoaXMuc3RhcnRUaW1lLCAzMCk7DQogICAgICAgIHJldHVybiB7IHN0YXJ0OiBzLCBzdGVwOiAnMDA6MzAnLCBlbmQ6IG9wZW5FbmQgfTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIC8vIHVzZSBlYXJsaWVzdFN0YXJ0Rm9yUGlja2VyIGFzIGJhc2lzDQogICAgICAgIGlmICh0aGlzLnN0YXJ0RGF0ZSA9PT0gdGhpcy5fdG9kYXlTdHIoKSkgew0KICAgICAgICAgIGNvbnN0IGJhc2UgPSB0aGlzLmVhcmxpZXN0U3RhcnRGb3JQaWNrZXIgJiYgdGhpcy5lYXJsaWVzdFN0YXJ0Rm9yUGlja2VyLmxlbmd0aCA/IHRoaXMuZWFybGllc3RTdGFydEZvclBpY2tlciA6ICcwODowMCc7DQogICAgICAgICAgY29uc3QgcyA9IHRoaXMuX2FkZE1pbnV0ZXNUb1RpbWVTdHIoYmFzZSwgMzApOw0KICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzLCBzdGVwOiAnMDA6MzAnLCBlbmQ6IG9wZW5FbmQgfTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICByZXR1cm4geyBzdGFydDogJzA4OjMwJywgc3RlcDogJzAwOjMwJywgZW5kOiBvcGVuRW5kIH07DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KDQoNCiAgY3JlYXRlZCgpIHsNCiAgICBjb25zdCB0eXBlID0gdGhpcy4kcm91dGUucXVlcnkudHlwZSA/IHRoaXMuJHJvdXRlLnF1ZXJ5LnR5cGUgOiAnJzsNCiAgICB0aGlzLmluaXQodHlwZSk7DQogICAgdGhpcy5iYXNlVXJsID0gdGhpcy4kY29uZmlnID8gdGhpcy4kY29uZmlnLmJhc2VVcmwgOiAnJzsNCiAgICB0aGlzLnJlZnJlc2hFYXJsaWVzdFN0YXJ0KCk7IC8vIGluaXRpYWxpemUgZWFybGllc3QNCiAgICAvLyBzZXNzaW9uIHVzZXINCiAgICB0aGlzLiRodHRwLmdldCh0aGlzLnVzZXJUYWJsZU5hbWUgKyAnL3Nlc3Npb24nLCB7IGVtdWxhdGVKU09OOiB0cnVlIH0pLnRoZW4ocmVzID0+IHsNCiAgICAgIGlmIChyZXMuZGF0YSAmJiByZXMuZGF0YS5jb2RlID09IDApIHsNCiAgICAgICAgdGhpcy5zZXNzaW9uVXNlciA9IHJlcy5kYXRhLmRhdGEgfHwge307DQogICAgICB9DQogICAgfSkuY2F0Y2goKCk9Pnt9KTsNCiAgICAvLyBwcmVmaWxsIGZyb20gYXZhaWxhYmlsaXR5U2VsZWN0aW9uIGlmIGV4aXN0cw0KICAgIGNvbnN0IHBpY2tSYXcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYXZhaWxhYmlsaXR5U2VsZWN0aW9uJyk7DQogICAgaWYgKHBpY2tSYXcpIHsNCiAgICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHBpY2sgPSBKU09OLnBhcnNlKHBpY2tSYXcpOw0KICAgICAgICBpZiAocGljayAmJiBwaWNrLnN0YXJ0ICYmIHBpY2suZW5kKSB7DQogICAgICAgICAgY29uc3QgcyA9IHBpY2suc3RhcnQuc3BsaXQoJyAnKTsNCiAgICAgICAgICBjb25zdCBlID0gcGljay5lbmQuc3BsaXQoJyAnKTsNCiAgICAgICAgICB0aGlzLnN0YXJ0RGF0ZSA9IHNbMF07DQogICAgICAgICAgdGhpcy5zdGFydFRpbWUgPSBzWzFdID8gc1sxXS5zbGljZSgwLDUpIDogJyc7DQogICAgICAgICAgdGhpcy5lbmRUaW1lID0gZVsxXSA/IGVbMV0uc2xpY2UoMCw1KSA6ICcnOw0KICAgICAgICB9DQogICAgICB9IGNhdGNoIChlKSB7fQ0KICAgIH0NCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBzdGFydERhdGUoKSB7DQogICAgICAvLyByZWZyZXNoIGVhcmxpZXN0IHdoZW4gZGF0ZSBjaGFuZ2VzDQogICAgICB0aGlzLnJlZnJlc2hFYXJsaWVzdFN0YXJ0KCk7DQogICAgICAvLyByZXNldCBlbmRUaW1lIHNvIHVzZXIgcmVzZWxlY3QgaWYgbmVlZGVkDQogICAgICB0aGlzLmVuZFRpbWUgPSAnJzsNCiAgICAgIC8vIGlmIHN0YXJ0VGltZSBlYXJsaWVyIHRoYW4gZWFybGllc3RTdGFydCwgYWRqdXN0DQogICAgICBpZiAodGhpcy5zdGFydFRpbWUgJiYgdGhpcy5zdGFydERhdGUgPT09IHRoaXMuX3RvZGF5U3RyKCkpIHsNCiAgICAgICAgY29uc3QgZWFybGllc3RNaW4gPSB0aGlzLl90aW1lU3RyVG9NaW51dGVzKHRoaXMuZWFybGllc3RTdGFydEZvclBpY2tlciB8fCAnMDg6MDAnKTsNCiAgICAgICAgaWYgKHRoaXMuX3RpbWVTdHJUb01pbnV0ZXModGhpcy5zdGFydFRpbWUpIDwgZWFybGllc3RNaW4pIHsNCiAgICAgICAgICB0aGlzLnN0YXJ0VGltZSA9IHRoaXMuZWFybGllc3RTdGFydEZvclBpY2tlcjsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGluaXQodHlwZSkgew0KICAgICAgdGhpcy50eXBlID0gdHlwZTsNCiAgICAgIGlmICh0eXBlID09ICdjcm9zcycpIHsNCiAgICAgICAgY29uc3Qgb2JqID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3Jvc3NPYmonKSB8fCAne30nKTsNCiAgICAgICAgaWYgKG9iai5taW5nY2hlbmcpIHsgdGhpcy5ydWxlRm9ybS5taW5nY2hlbmcgPSBvYmoubWluZ2NoZW5nOyB0aGlzLnJvLm1pbmdjaGVuZyA9IHRydWU7IH0NCiAgICAgICAgaWYgKG9iai50dXBpYW4pIHsgdGhpcy5ydWxlRm9ybS50dXBpYW4gPSAob2JqLnR1cGlhbiAmJiBvYmoudHVwaWFuLnNwbGl0KSA/IG9iai50dXBpYW4uc3BsaXQoJywnKVswXSA6IG9iai50dXBpYW47IHRoaXMucm8udHVwaWFuID0gdHJ1ZTsgfQ0KICAgICAgICBpZiAob2JqLmd1aW1vKSB7IHRoaXMucnVsZUZvcm0uZ3VpbW8gPSBvYmouZ3VpbW87IHRoaXMucm8uZ3VpbW8gPSB0cnVlOyB9DQogICAgICAgIGlmIChvYmouenVvd2VpKSB7IHRoaXMucnVsZUZvcm0uenVvd2VpID0gb2JqLnp1b3dlaTsgdGhpcy5yby56dW93ZWkgPSB0cnVlOyB9DQogICAgICAgIGlmIChvYmoud2VpemhpKSB7IHRoaXMucnVsZUZvcm0ud2VpemhpID0gb2JqLndlaXpoaTsgdGhpcy5yby53ZWl6aGkgPSB0cnVlOyB9DQogICAgICAgIGlmIChvYmouc2hlc2hpKSB7IHRoaXMucnVsZUZvcm0uc2hlc2hpID0gb2JqLnNoZXNoaTsgdGhpcy5yby5zaGVzaGkgPSB0cnVlOyB9DQogICAgICAgIGlmIChvYmoua2V5dWVzaGlqaWFuKSB7IHRoaXMucnVsZUZvcm0ua2V5dWVzaGlqaWFuID0gb2JqLmtleXVlc2hpamlhbjsgdGhpcy5yby5rZXl1ZXNoaWppYW4gPSB0cnVlOyB9DQogICAgICAgIGlmIChvYmouc2hpZm91eW91a2UpIHsgdGhpcy5ydWxlRm9ybS5zaGlmb3V5b3VrZSA9IG9iai5zaGlmb3V5b3VrZTsgdGhpcy5yby5zaGlmb3V5b3VrZSA9IHRydWU7IH0NCiAgICAgICAgaWYgKG9iai54aWFuZ3FpbmcpIHsgdGhpcy5ydWxlRm9ybS54aWFuZ3FpbmcgPSBvYmoueGlhbmdxaW5nOyB0aGlzLnJvLnhpYW5ncWluZyA9IHRydWU7IH0NCiAgICAgIH0NCiAgICAgIHRoaXMuZ3VpbW9PcHRpb25zID0gIuWkp+WeiyzkuK3lnoss5bCP5Z6LIi5zcGxpdCgnLCcpOw0KICAgICAgdGhpcy5zaGlmb3V5b3VrZU9wdGlvbnMgPSAi5pivLOWQpiIuc3BsaXQoJywnKTsNCiAgICB9LA0KDQogICAgLy8gcmVmcmVzaCBlYXJsaWVzdCBzdGFydCBmcm9tIGJyb3dzZXIgKGR5bmFtaWMpDQogICAgcmVmcmVzaEVhcmxpZXN0U3RhcnQoKSB7DQogICAgICAvLyBvbmx5IGNvbXB1dGUgd2hlbiBzdGFydERhdGUgaXMgdG9kYXk7IGVsc2Ugc2V0IGVtcHR5DQogICAgICBpZiAodGhpcy5zdGFydERhdGUgPT09IHRoaXMuX3RvZGF5U3RyKCkpIHsNCiAgICAgICAgY29uc3QgciA9IHRoaXMuX3JvdW5kVXBUbzMwKG5ldyBEYXRlKCkpOw0KICAgICAgICB0aGlzLmVhcmxpZXN0U3RhcnRGb3JQaWNrZXIgPSB0aGlzLl90aW1lU3RyRnJvbURhdGUocik7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLmVhcmxpZXN0U3RhcnRGb3JQaWNrZXIgPSAnJzsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgX3RvZGF5U3RyKCkgew0KICAgICAgY29uc3QgZCA9IG5ldyBEYXRlKCk7DQogICAgICByZXR1cm4gZC5nZXRGdWxsWWVhcigpICsgJy0nICsgKCcwJysoZC5nZXRNb250aCgpKzEpKS5zbGljZSgtMikgKyAnLScgKyAoJzAnK2QuZ2V0RGF0ZSgpKS5zbGljZSgtMik7DQogICAgfSwNCg0KICAgIF9yb3VuZFVwVG8zMChkKSB7DQogICAgICBjb25zdCBtID0gZC5nZXRNaW51dGVzKCk7DQogICAgICBjb25zdCBuZXdEYXRlID0gbmV3IERhdGUoZCk7DQogICAgICBpZiAobSA+IDAgJiYgbSA8PSAzMCkgew0KICAgICAgICBuZXdEYXRlLnNldE1pbnV0ZXMoMzApOw0KICAgICAgfSBlbHNlIGlmIChtID4gMzApIHsNCiAgICAgICAgbmV3RGF0ZS5zZXRIb3VycyhkLmdldEhvdXJzKCkgKyAxKTsNCiAgICAgICAgbmV3RGF0ZS5zZXRNaW51dGVzKDApOw0KICAgICAgfQ0KICAgICAgbmV3RGF0ZS5zZXRTZWNvbmRzKDApOw0KICAgICAgbmV3RGF0ZS5zZXRNaWxsaXNlY29uZHMoMCk7DQogICAgICByZXR1cm4gbmV3RGF0ZTsNCiAgICB9LA0KDQogICAgX2N1cnJlbnRUaW1lU3RyKCkgew0KICAgICAgY29uc3QgbiA9IG5ldyBEYXRlKCk7DQogICAgICByZXR1cm4gKCcwJytuLmdldEhvdXJzKCkpLnNsaWNlKC0yKSArICI6IiArICgnMCcrbi5nZXRNaW51dGVzKCkpLnNsaWNlKC0yKTsNCiAgICB9LA0KDQogICAgX3RpbWVTdHJGcm9tRGF0ZShkKSB7DQogICAgICBjb25zdCBoaCA9ICgnMCcrZC5nZXRIb3VycygpKS5zbGljZSgtMik7DQogICAgICBjb25zdCBtbSA9ICgnMCcrZC5nZXRNaW51dGVzKCkpLnNsaWNlKC0yKTsNCiAgICAgIHJldHVybiBgJHtoaH06JHttbX1gOw0KICAgIH0sDQoNCiAgICAvLyDliIfmjaLml6XmnJ/ml7bvvIzph43nva7ml7bpl7TpmLLmraLlhrLnqoENCiAgICBvbkRhdGVDaGFuZ2UoKSB7DQogICAgICB0aGlzLnN0YXJ0VGltZSA9ICcnOw0KICAgICAgdGhpcy5lbmRUaW1lID0gJyc7DQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgIHRoaXMuc2V0RGVmYXVsdFN0YXJ0VGltZSgpOw0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIHNldERlZmF1bHRTdGFydFRpbWUoKSB7DQogICAgICBpZiAodGhpcy50eXBlICE9PSAnY3Jvc3MnKSByZXR1cm47DQogICAgICBjb25zdCBlYXJsaWVzdCA9IHRoaXMuX2VhcmxpZXN0U3RhcnRGb3JEYXRlKHRoaXMuc3RhcnREYXRlKTsNCiAgICAgIHRoaXMuc3RhcnRUaW1lID0gZWFybGllc3Q7DQogICAgICB0aGlzLmVuZFRpbWUgPSB0aGlzLl9hZGRNaW51dGVzVG9UaW1lU3RyKHRoaXMuc3RhcnRUaW1lLCAzMCk7DQogICAgfSwNCg0KICAgIF9hZGRNaW51dGVzVG9UaW1lU3RyKHRpbWVTdHIsIGFkZE1pbikgew0KICAgICAgaWYgKCF0aW1lU3RyKSByZXR1cm4gdGltZVN0cjsNCiAgICAgIGNvbnN0IHBhcnRzID0gdGltZVN0ci5zcGxpdCgnOicpOw0KICAgICAgY29uc3QgZCA9IG5ldyBEYXRlKCk7DQogICAgICBkLnNldEhvdXJzKHBhcnNlSW50KHBhcnRzWzBdLDEwKSwgcGFyc2VJbnQocGFydHNbMV0sMTApLCAwLCAwKTsNCiAgICAgIGQuc2V0TWludXRlcyhkLmdldE1pbnV0ZXMoKSArIGFkZE1pbik7DQogICAgICByZXR1cm4gKCcwJytkLmdldEhvdXJzKCkpLnNsaWNlKC0yKSArICc6JyArICgnMCcrZC5nZXRNaW51dGVzKCkpLnNsaWNlKC0yKTsNCiAgICB9LA0KDQogICAgX3RpbWVTdHJUb01pbnV0ZXModGltZVN0cikgew0KICAgICAgY29uc3QgcCA9IHRpbWVTdHIuc3BsaXQoJzonKTsNCiAgICAgIHJldHVybiBwYXJzZUludChwWzBdLDEwKSo2MCArIHBhcnNlSW50KHBbMV0sMTApOw0KICAgIH0sDQoNCiAgICB2YWxpZGF0ZUJlZm9yZVN1Ym1pdChzdGFydERhdGVUaW1lLCBlbmREYXRlVGltZSkgew0KICAgICAgY29uc3QgZ3JhbiA9IDMwOw0KICAgICAgY29uc3QgZ3Jhbk1zID0gZ3JhbiAqIDYwICogMTAwMDsNCg0KICAgICAgaWYgKGVuZERhdGVUaW1lIDw9IHN0YXJ0RGF0ZVRpbWUpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign57uT5p2f5pe26Ze05b+F6aG75pma5LqO5byA5aeL5pe26Ze0Jyk7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0NCiAgICAgIGlmICgoc3RhcnREYXRlVGltZS5nZXRTZWNvbmRzKCkgIT09IDApIHx8IChzdGFydERhdGVUaW1lLmdldE1pbGxpc2Vjb25kcygpICE9PSAwKSB8fA0KICAgICAgICAgIChlbmREYXRlVGltZS5nZXRTZWNvbmRzKCkgIT09IDApIHx8IChlbmREYXRlVGltZS5nZXRNaWxsaXNlY29uZHMoKSAhPT0gMCkpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6K+35oqK56eS5ZKM5q+r56eS6K6+572u5Li6IDAnKTsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgfQ0KICAgICAgaWYgKHN0YXJ0RGF0ZVRpbWUuZ2V0TWludXRlcygpICUgZ3JhbiAhPT0gMCB8fCBlbmREYXRlVGltZS5nZXRNaW51dGVzKCkgJSBncmFuICE9PSAwKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+W8gOWniy/nu5PmnZ/ml7bpl7Tlv4XpobvkuLogMzAg5YiG6ZKf55qE5YCN5pWw77yI5L6L5aaCIDA4OjAwIOaIliAwODozMO+8iScpOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICB9DQogICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOw0KICAgICAgaWYgKHN0YXJ0RGF0ZVRpbWUudG9JU09TdHJpbmcoKS5zbGljZSgwLCAxMCkgPT09IG5vdy50b0lTT1N0cmluZygpLnNsaWNlKDAsIDEwKSkgew0KICAgICAgICBjb25zdCByb3VuZGVkTm93TXMgPSBNYXRoLmNlaWwobm93LmdldFRpbWUoKSAvIGdyYW5NcykgKiBncmFuTXM7DQogICAgICAgIGlmIChzdGFydERhdGVUaW1lLmdldFRpbWUoKSA8IHJvdW5kZWROb3dNcykgew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoYOW9k+WkqemihOe6puW/hemhu+WcqOW9k+WJjeaXtumXtOS5i+WQju+8iOaMiTMw5YiG6ZKf5Y+W5pW077yJ77yMYCk7DQogICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICB9DQogICAgICBpZiAoKGVuZERhdGVUaW1lLmdldFRpbWUoKSAtIHN0YXJ0RGF0ZVRpbWUuZ2V0VGltZSgpKSAlIGdyYW5NcyAhPT0gMCkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfpooTnuqbml7bplb/lv4XpobvkuLogMzAg5YiG6ZKf55qE5YCN5pWwJyk7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0NCiAgICAgIHJldHVybiB0cnVlOw0KICAgIH0sDQoNCiAgICBhc3luYyBvblN1Ym1pdCgpIHsNCiAgICAgIHRoaXMuJHJlZnNbInJ1bGVGb3JtIl0udmFsaWRhdGUoYXN5bmMgdmFsaWQgPT4gew0KICAgICAgICBpZiAoIXZhbGlkKSByZXR1cm47DQogICAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdjcm9zcycpIHsNCiAgICAgICAgICBpZiAoIXRoaXMuc3RhcnREYXRlIHx8ICF0aGlzLnN0YXJ0VGltZSB8fCAhdGhpcy5lbmRUaW1lKSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfor7flhYjpgInmi6npooTnuqbml6XmnJ/kuI7ml7bpl7QnKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICB9DQogICAgICAgICAgLy8gZW5zdXJlIGVhcmxpZXN0IGNvbXB1dGVkIGZyZXNoDQogICAgICAgICAgdGhpcy5yZWZyZXNoRWFybGllc3RTdGFydCgpOw0KDQogICAgICAgICAgY29uc3Qgc3RhcnREdCA9IG5ldyBEYXRlKGAke3RoaXMuc3RhcnREYXRlfSAke3RoaXMuc3RhcnRUaW1lfTowMGApOw0KICAgICAgICAgIGNvbnN0IGVuZER0ID0gbmV3IERhdGUoYCR7dGhpcy5zdGFydERhdGV9ICR7dGhpcy5lbmRUaW1lfTowMGApOw0KICAgICAgICAgIGlmICghdGhpcy52YWxpZGF0ZUJlZm9yZVN1Ym1pdChzdGFydER0LCBlbmREdCkpIHJldHVybjsNCg0KICAgICAgICAgIGNvbnN0IGNyb3NzT2JqID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3Jvc3NPYmonKSB8fCAne30nKTsNCiAgICAgICAgICBjb25zdCBwYXlsb2FkID0gew0KICAgICAgICAgICAgeml4aXNoaWlkOiBjcm9zc09iai5pZCB8fCBjcm9zc09iai56aXhpc2hpSWQgfHwgbnVsbCwNCiAgICAgICAgICAgIHp1b3dlaTogcGFyc2VJbnQodGhpcy5ydWxlRm9ybS56dW93ZWkgfHwgY3Jvc3NPYmouenVvd2VpIHx8IDAsIDEwKSwNCiAgICAgICAgICAgIHh1ZWhhbzogdGhpcy5zZXNzaW9uVXNlciAmJiAodGhpcy5zZXNzaW9uVXNlci51c2VybmFtZSB8fCB0aGlzLnNlc3Npb25Vc2VyLnh1ZWhhbykgPyAodGhpcy5zZXNzaW9uVXNlci51c2VybmFtZSB8fCB0aGlzLnNlc3Npb25Vc2VyLnh1ZWhhbykgOiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJuYW1lJykgfHwgJycpLA0KICAgICAgICAgICAgeGluZ21pbmc6IHRoaXMuc2Vzc2lvblVzZXIgJiYgKHRoaXMuc2Vzc2lvblVzZXIubmFtZSB8fCB0aGlzLnNlc3Npb25Vc2VyLnhpbmdtaW5nKSA/ICh0aGlzLnNlc3Npb25Vc2VyLm5hbWUgfHwgdGhpcy5zZXNzaW9uVXNlci54aW5nbWluZykgOiAnJywNCiAgICAgICAgICAgIHNob3VqaTogdGhpcy5zZXNzaW9uVXNlciAmJiAodGhpcy5zZXNzaW9uVXNlci5zaG91amkgfHwgdGhpcy5zZXNzaW9uVXNlci5tb2JpbGUpID8gKHRoaXMuc2Vzc2lvblVzZXIuc2hvdWppIHx8IHRoaXMuc2Vzc2lvblVzZXIubW9iaWxlKSA6ICcnLA0KICAgICAgICAgICAgeXV5dWVTdGFydDogdGhpcy5fZm9ybWF0RGF0ZShzdGFydER0KSwNCiAgICAgICAgICAgIHl1eXVlRW5kOiB0aGlzLl9mb3JtYXREYXRlKGVuZER0KSwNCiAgICAgICAgICAgIG1pbmdjaGVuZzogdGhpcy5ydWxlRm9ybS5taW5nY2hlbmcgfHwgY3Jvc3NPYmoubWluZ2NoZW5nIHx8ICcnDQogICAgICAgICAgfTsNCg0KICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLiRodHRwLnBvc3QoJy95dXl1ZXhpbnhpL3N1Ym1pdCcsIHBheWxvYWQpOw0KICAgICAgICAgICAgaWYgKHJlcyAmJiByZXMuZGF0YSAmJiByZXMuZGF0YS5jb2RlID09PSAwKSB7DQogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoeyBtZXNzYWdlOiAn6aKE57qm5oiQ5YqfJywgdHlwZTogJ3N1Y2Nlc3MnLCBkdXJhdGlvbjogMTUwMCwgb25DbG9zZTogKCk9PiB7IHRoaXMuJHJvdXRlci5nbygtMSk7IH19KTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzICYmIHJlcy5kYXRhICYmIHJlcy5kYXRhLm1zZyA/IHJlcy5kYXRhLm1zZyA6ICfpooTnuqblpLHotKUnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3N1Ym1pdCBlcnJvcicsIGVycik7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfpooTnuqbor7fmsYLlpLHotKUnKTsNCiAgICAgICAgICB9DQogICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gbm9uLWNyb3NzOiBjcmVhdGUgc3R1ZHkgcm9vbQ0KICAgICAgICB0cnkgew0KICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuJGh0dHAucG9zdCgneml4aXNoaS9hZGQnLCB0aGlzLnJ1bGVGb3JtKTsNCiAgICAgICAgICBpZiAocmVzICYmIHJlcy5kYXRhICYmIHJlcy5kYXRhLmNvZGUgPT0gMCkgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7IG1lc3NhZ2U6ICfmk43kvZzmiJDlip8nLCB0eXBlOiAnc3VjY2VzcycsIGR1cmF0aW9uOiAxNTAwLCBvbkNsb3NlOiAoKSA9PiB7IHRoaXMuJHJvdXRlci5nbygtMSk7IH19KTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMgJiYgcmVzLmRhdGEgJiYgcmVzLmRhdGEubXNnID8gcmVzLmRhdGEubXNnIDogJ+aTjeS9nOWksei0pScpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+axguWksei0pScpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KDQogICAgX2Zvcm1hdERhdGUoZCkgew0KICAgICAgY29uc3QgWSA9IGQuZ2V0RnVsbFllYXIoKTsNCiAgICAgIGNvbnN0IE0gPSAoJzAnKyhkLmdldE1vbnRoKCkrMSkpLnNsaWNlKC0yKTsNCiAgICAgIGNvbnN0IEQgPSAoJzAnK2QuZ2V0RGF0ZSgpKS5zbGljZSgtMik7DQogICAgICBjb25zdCBoID0gKCcwJytkLmdldEhvdXJzKCkpLnNsaWNlKC0yKTsNCiAgICAgIGNvbnN0IG0gPSAoJzAnK2QuZ2V0TWludXRlcygpKS5zbGljZSgtMik7DQogICAgICBjb25zdCBzID0gKCcwJytkLmdldFNlY29uZHMoKSkuc2xpY2UoLTIpOw0KICAgICAgcmV0dXJuIGAke1l9LSR7TX0tJHtEfSAke2h9OiR7bX06JHtzfWA7DQogICAgfSwNCg0KICAgIGRpc2FibGVkQXZhaWxhYmlsaXR5RGF0ZShkYXRlKSB7DQogICAgICBpZiAoIWRhdGUpIHJldHVybiB0cnVlOw0KICAgICAgY29uc3QgZCA9IG5ldyBEYXRlKGRhdGUpOw0KICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpOw0KICAgICAgdG9kYXkuc2V0SG91cnMoMCwwLDAsMCk7DQogICAgICBjb25zdCBtYXggPSBuZXcgRGF0ZSh0b2RheSk7DQogICAgICBtYXguc2V0RGF0ZSh0b2RheS5nZXREYXRlKCkgKyAxKTsNCiAgICAgIG1heC5zZXRIb3VycygyMyw1OSw1OSw5OTkpOw0KICAgICAgcmV0dXJuIGQgPCB0b2RheSB8fCBkID4gbWF4Ow0KICAgIH0sDQoNCiAgICB0dXBpYW5VcGxvYWRDaGFuZ2UoZmlsZVVybHMpIHsNCiAgICAgIHRoaXMucnVsZUZvcm0udHVwaWFuID0gZmlsZVVybHMucmVwbGFjZShuZXcgUmVnRXhwKHRoaXMuJGNvbmZpZy5iYXNlVXJsLCAiZyIpLCAiIik7DQogICAgfSwNCg0KICAgIGdldFVVSUQoKSB7IHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTsgfSwNCiAgICBiYWNrKCkgeyB0aGlzLiRyb3V0ZXIuZ28oLTEpOyB9DQogIH0NCn07DQo="},{"version":3,"sources":["add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"add.vue","sourceRoot":"src/pages/zixishi","sourcesContent":["<template>\r\n  <div :style='{\"width\":\"1000px\",\"padding\":\"20px\",\"boxShadow\":\"0px 4px 10px 0px rgba(0,0,0,0.302)\",\"margin\":\"10px auto\",\"position\":\"relative\",\"background\":\"#fff\"}'>\r\n    <el-form\r\n        class=\"add-update-preview\"\r\n        ref=\"ruleForm\"\r\n        :model=\"ruleForm\"\r\n        :rules=\"rules\"\r\n        label-width=\"120px\"\r\n    >\r\n      <el-form-item :style='{\"width\":\"80%\",\"padding\":\"10px\",\"margin\":\"0 2% 10px\",\"display\":\"inline-block\"}' label=\"名称\" prop=\"mingcheng\">\r\n        <el-input v-model=\"ruleForm.mingcheng\" placeholder=\"名称\" clearable></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item\r\n          :key=\"'tupian-upload-' + type\"\r\n          :style='{\"width\":\"80%\",\"padding\":\"10px\",\"margin\":\"0 2% 10px\",\"display\":\"inline-block\"}'\r\n          label=\"图片\"\r\n          v-if=\"type!='cross' || (type=='cross' && !ro.tupian)\"\r\n          prop=\"tupian\"\r\n      >\r\n        <file-upload\r\n            tip=\"点击上传图片\"\r\n            action=\"file/upload\"\r\n            :limit=\"3\"\r\n            :multiple=\"true\"\r\n            :fileUrls=\"ruleForm.tupian?ruleForm.tupian:''\"\r\n            @change=\"tupianUploadChange\"\r\n        ></file-upload>\r\n      </el-form-item>\r\n\r\n      <el-form-item\r\n          :key=\"'tupian-preview-' + type\"\r\n          :style='{\"width\":\"80%\",\"padding\":\"10px\",\"margin\":\"0 2% 10px\",\"display\":\"inline-block\"}'\r\n          class=\"upload\"\r\n          v-else\r\n          label=\"图片\"\r\n          prop=\"tupian\"\r\n      >\r\n        <img\r\n            v-if=\"ruleForm.tupian && ruleForm.tupian.substring && ruleForm.tupian.substring(0,4)=='http'\"\r\n            class=\"upload-img\"\r\n            style=\"margin-right:20px;\"\r\n            :src=\"ruleForm.tupian.split(',')[0]\"\r\n            width=\"100\" height=\"100\"\r\n        />\r\n        <template v-else>\r\n          <img\r\n              v-for=\"(item,index) in (ruleForm.tupian ? ruleForm.tupian.split(',') : [])\"\r\n              :key=\"'preview-'+index\"\r\n              class=\"upload-img\"\r\n              style=\"margin-right:20px;\"\r\n              :src=\"baseUrl + item\"\r\n              width=\"100\" height=\"100\"\r\n          />\r\n        </template>\r\n      </el-form-item>\r\n\r\n      <el-form-item :style='{\"width\":\"80%\",\"padding\":\"10px\",\"margin\":\"0 2% 10px\",\"display\":\"inline-block\"}' label=\"规模\" prop=\"guimo\">\r\n        <el-select v-model=\"ruleForm.guimo\" placeholder=\"请选择规模\">\r\n          <el-option v-for=\"(item,index) in guimoOptions\" :key=\"index\" :label=\"item\" :value=\"item\" />\r\n        </el-select>\r\n      </el-form-item>\r\n\r\n      <el-form-item :style='{\"width\":\"80%\",\"padding\":\"10px\",\"margin\":\"0 2% 10px\",\"display\":\"inline-block\"}' label=\"座位\" prop=\"zuowei\">\r\n        <el-input v-model=\"ruleForm.zuowei\" placeholder=\"座位\" clearable readonly></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item :style='{\"width\":\"80%\",\"padding\":\"10px\",\"margin\":\"0 2% 10px\",\"display\":\"inline-block\"}' label=\"位置\" prop=\"weizhi\">\r\n        <el-input v-model=\"ruleForm.weizhi\" placeholder=\"位置\" clearable></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item :style='{\"width\":\"80%\",\"padding\":\"10px\",\"margin\":\"0 2% 10px\",\"display\":\"inline-block\"}' label=\"设施\" prop=\"sheshi\">\r\n        <el-input v-model=\"ruleForm.sheshi\" placeholder=\"设施\" clearable></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item :style='{\"width\":\"80%\",\"padding\":\"10px\",\"margin\":\"0 2% 10px\",\"display\":\"inline-block\"}' label=\"可约时间\" prop=\"keyueshijian\">\r\n        <el-input v-model=\"ruleForm.keyueshijian\" placeholder=\"可约时间\" clearable></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item :style='{\"width\":\"80%\",\"padding\":\"10px\",\"margin\":\"0 2% 10px\",\"display\":\"inline-block\"}' label=\"是否有课\" prop=\"shifouyouke\">\r\n        <el-select v-model=\"ruleForm.shifouyouke\" placeholder=\"请选择是否有课\">\r\n          <el-option v-for=\"(item,index) in shifouyoukeOptions\" :key=\"index\" :label=\"item\" :value=\"item\" />\r\n        </el-select>\r\n      </el-form-item>\r\n\r\n      <el-form-item :style='{\"width\":\"80%\",\"padding\":\"10px\",\"margin\":\"0 2% 10px\",\"display\":\"inline-block\"}' label=\"详情\" prop=\"xiangqing\">\r\n        <editor\r\n            :style='{\"minHeight\":\"400px\",\"padding\":\"0\",\"boxShadow\":\"0 0 6px #2e61e1\",\"margin\":\"0\",\"borderColor\":\"#ccc\",\"backgroundColor\":\"#fff\",\"borderRadius\":\"0\",\"color\":\"#000\",\"borderWidth\":\"0\",\"width\":\"100%\",\"borderStyle\":\"solid\",\"height\":\"auto\"}'\r\n            v-model=\"ruleForm.xiangqing\"\r\n            class=\"editor\"\r\n            action=\"file/upload\">\r\n        </editor>\r\n      </el-form-item>\r\n\r\n      <!-- 跨表预约：今/明 + 固定时间下拉（30 分钟步进），起始首项动态取自浏览器时间向上取至下一个 30 分钟 -->\r\n      <el-form-item v-if=\"type==='cross'\" label=\"预约时间\" :style='{\"width\":\"80%\",\"padding\":\"10px\",\"margin\":\"0 2% 10px\",\"display\":\"block\"}'>\r\n        <div class=\"time-select-container\">\r\n          <el-date-picker\r\n              v-model=\"startDate\"\r\n              type=\"date\"\r\n              placeholder=\"选择日期\"\r\n              :disabled-date=\"disabledAvailabilityDate\"\r\n              value-format=\"yyyy-MM-dd\"\r\n              @change=\"onDateChange\"\r\n          />\r\n          <el-time-select\r\n              v-model=\"startTime\"\r\n              placeholder=\"起始时间\"\r\n              :picker-options=\"timeStartOptions\"\r\n          />\r\n          <el-time-select\r\n              v-model=\"endTime\"\r\n              placeholder=\"结束时间\"\r\n              :picker-options=\"timeEndOptions\"\r\n          />\r\n        </div>\r\n        <div class=\"time-tip\">\r\n          * 粒度为 30 分钟。若选择今天，可选时间已根据当前时间 ({{_currentTimeStr()}}) 自动延后。\r\n        </div>\r\n      </el-form-item>\r\n\r\n      <el-form-item :style='{\"padding\":\"0\",\"margin\":\"0\"}'>\r\n        <el-button type=\"primary\" @click=\"onSubmit\" :style='{\"border\":\"0\",\"cursor\":\"pointer\",\"padding\":\"0\",\"margin\":\"0 20px 0 0\",\"outline\":\"none\",\"borderRadius\":\"4px\",\"width\":\"128px\",\"lineHeight\":\"40px\",\"fontSize\":\"14px\",\"height\":\"40px\"}'>提交</el-button>\r\n        <el-button @click=\"back\" :style='{\"border\":\"0px solid rgba(64, 158, 255, 1)\",\"cursor\":\"pointer\",\"padding\":\"0\",\"margin\":\"0\",\"outline\":\"none\",\"borderRadius\":\"4px\",\"width\":\"128px\",\"lineHeight\":\"40px\",\"fontSize\":\"14px\",\"height\":\"40px\"}'>返回</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      id: '',\r\n      baseUrl: '',\r\n      ro:{\r\n        mingcheng : false,\r\n        tupian : false,\r\n        guimo : false,\r\n        zuowei : false,\r\n        weizhi : false,\r\n        sheshi : false,\r\n        keyueshijian : false,\r\n        shifouyouke : false,\r\n        xiangqing : false,\r\n      },\r\n      type: '',\r\n      userTableName: localStorage.getItem('UserTableName') || 'xuesheng',\r\n      ruleForm: {\r\n        mingcheng: '',\r\n        tupian: '',\r\n        guimo: '',\r\n        zuowei: '20',\r\n        weizhi: '',\r\n        sheshi: '',\r\n        keyueshijian: '',\r\n        shifouyouke: '是',\r\n        xiangqing: '',\r\n      },\r\n      guimoOptions: [],\r\n      shifouyoukeOptions: [],\r\n      rules: {\r\n        mingcheng: [{ required: true, message: '名称不能为空', trigger: 'blur' }],\r\n        zuowei: [{ validator: this.$validate ? this.$validate.isIntNumer : () => true, trigger: 'blur' }],\r\n        weizhi: [{ required: true, message: '位置不能为空', trigger: 'blur' }],\r\n      },\r\n\r\n      // appointment controls\r\n      startDate: new Date().toISOString().slice(0,10),\r\n      startTime: '', // 'HH:mm'\r\n      endTime: '',\r\n\r\n      // reactive earliest start computed from browser time; refresh on focus or date change\r\n      earliestStartForPicker: '',\r\n\r\n      sessionUser: {}\r\n    };\r\n  },\r\n  computed: {\r\n    timeStartOptions() {\r\n      let openStart = '08:00';\r\n      const lastStart = '21:30';\r\n\r\n      // 如果选择的是今天\r\n      if (this.startDate === this._todayStr()) {\r\n        const now = new Date();\r\n        const roundedNow = this._roundUpTo30(now);\r\n        const minAvailable = this._timeStrFromDate(roundedNow);\r\n\r\n        // 如果当前时间已经过了 21:30，则今天无法预约\r\n        if (this._timeStrToMinutes(minAvailable) > this._timeStrToMinutes(lastStart)) {\r\n          openStart = '23:59'; // 使得列表为空\r\n        } else {\r\n          // 取 08:00 和当前取整时间中的较大者\r\n          openStart = this._timeStrToMinutes(minAvailable) > this._timeStrToMinutes(openStart)\r\n              ? minAvailable : openStart;\r\n        }\r\n      }\r\n      return { start: openStart, step: '00:30', end: lastStart };\r\n    },\r\n\r\n    timeEndOptions() {\r\n      const openEnd = '22:00';\r\n      // 结束时间至少比开始时间晚 30 分钟\r\n      const startLimit = this.startTime ? this._addMinutesToTimeStr(this.startTime, 30) : '08:30';\r\n      return {\r\n        start: startLimit,\r\n        step: '00:30',\r\n        end: openEnd,\r\n        minTime: this.startTime\r\n      };\r\n    }\r\n  },\r\n\r\n    timeEndOptions() {\r\n      const openEnd = '22:00';\r\n      if (this.startTime) {\r\n        const s = this._addMinutesToTimeStr(this.startTime, 30);\r\n        return { start: s, step: '00:30', end: openEnd };\r\n      } else {\r\n        // use earliestStartForPicker as basis\r\n        if (this.startDate === this._todayStr()) {\r\n          const base = this.earliestStartForPicker && this.earliestStartForPicker.length ? this.earliestStartForPicker : '08:00';\r\n          const s = this._addMinutesToTimeStr(base, 30);\r\n          return { start: s, step: '00:30', end: openEnd };\r\n        } else {\r\n          return { start: '08:30', step: '00:30', end: openEnd };\r\n        }\r\n      }\r\n    },\r\n\r\n\r\n  created() {\r\n    const type = this.$route.query.type ? this.$route.query.type : '';\r\n    this.init(type);\r\n    this.baseUrl = this.$config ? this.$config.baseUrl : '';\r\n    this.refreshEarliestStart(); // initialize earliest\r\n    // session user\r\n    this.$http.get(this.userTableName + '/session', { emulateJSON: true }).then(res => {\r\n      if (res.data && res.data.code == 0) {\r\n        this.sessionUser = res.data.data || {};\r\n      }\r\n    }).catch(()=>{});\r\n    // prefill from availabilitySelection if exists\r\n    const pickRaw = localStorage.getItem('availabilitySelection');\r\n    if (pickRaw) {\r\n      try {\r\n        const pick = JSON.parse(pickRaw);\r\n        if (pick && pick.start && pick.end) {\r\n          const s = pick.start.split(' ');\r\n          const e = pick.end.split(' ');\r\n          this.startDate = s[0];\r\n          this.startTime = s[1] ? s[1].slice(0,5) : '';\r\n          this.endTime = e[1] ? e[1].slice(0,5) : '';\r\n        }\r\n      } catch (e) {}\r\n    }\r\n  },\r\n  watch: {\r\n    startDate() {\r\n      // refresh earliest when date changes\r\n      this.refreshEarliestStart();\r\n      // reset endTime so user reselect if needed\r\n      this.endTime = '';\r\n      // if startTime earlier than earliestStart, adjust\r\n      if (this.startTime && this.startDate === this._todayStr()) {\r\n        const earliestMin = this._timeStrToMinutes(this.earliestStartForPicker || '08:00');\r\n        if (this._timeStrToMinutes(this.startTime) < earliestMin) {\r\n          this.startTime = this.earliestStartForPicker;\r\n        }\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    init(type) {\r\n      this.type = type;\r\n      if (type == 'cross') {\r\n        const obj = JSON.parse(localStorage.getItem('crossObj') || '{}');\r\n        if (obj.mingcheng) { this.ruleForm.mingcheng = obj.mingcheng; this.ro.mingcheng = true; }\r\n        if (obj.tupian) { this.ruleForm.tupian = (obj.tupian && obj.tupian.split) ? obj.tupian.split(',')[0] : obj.tupian; this.ro.tupian = true; }\r\n        if (obj.guimo) { this.ruleForm.guimo = obj.guimo; this.ro.guimo = true; }\r\n        if (obj.zuowei) { this.ruleForm.zuowei = obj.zuowei; this.ro.zuowei = true; }\r\n        if (obj.weizhi) { this.ruleForm.weizhi = obj.weizhi; this.ro.weizhi = true; }\r\n        if (obj.sheshi) { this.ruleForm.sheshi = obj.sheshi; this.ro.sheshi = true; }\r\n        if (obj.keyueshijian) { this.ruleForm.keyueshijian = obj.keyueshijian; this.ro.keyueshijian = true; }\r\n        if (obj.shifouyouke) { this.ruleForm.shifouyouke = obj.shifouyouke; this.ro.shifouyouke = true; }\r\n        if (obj.xiangqing) { this.ruleForm.xiangqing = obj.xiangqing; this.ro.xiangqing = true; }\r\n      }\r\n      this.guimoOptions = \"大型,中型,小型\".split(',');\r\n      this.shifouyoukeOptions = \"是,否\".split(',');\r\n    },\r\n\r\n    // refresh earliest start from browser (dynamic)\r\n    refreshEarliestStart() {\r\n      // only compute when startDate is today; else set empty\r\n      if (this.startDate === this._todayStr()) {\r\n        const r = this._roundUpTo30(new Date());\r\n        this.earliestStartForPicker = this._timeStrFromDate(r);\r\n      } else {\r\n        this.earliestStartForPicker = '';\r\n      }\r\n    },\r\n\r\n    _todayStr() {\r\n      const d = new Date();\r\n      return d.getFullYear() + '-' + ('0'+(d.getMonth()+1)).slice(-2) + '-' + ('0'+d.getDate()).slice(-2);\r\n    },\r\n\r\n    _roundUpTo30(d) {\r\n      const m = d.getMinutes();\r\n      const newDate = new Date(d);\r\n      if (m > 0 && m <= 30) {\r\n        newDate.setMinutes(30);\r\n      } else if (m > 30) {\r\n        newDate.setHours(d.getHours() + 1);\r\n        newDate.setMinutes(0);\r\n      }\r\n      newDate.setSeconds(0);\r\n      newDate.setMilliseconds(0);\r\n      return newDate;\r\n    },\r\n\r\n    _currentTimeStr() {\r\n      const n = new Date();\r\n      return ('0'+n.getHours()).slice(-2) + \":\" + ('0'+n.getMinutes()).slice(-2);\r\n    },\r\n\r\n    _timeStrFromDate(d) {\r\n      const hh = ('0'+d.getHours()).slice(-2);\r\n      const mm = ('0'+d.getMinutes()).slice(-2);\r\n      return `${hh}:${mm}`;\r\n    },\r\n\r\n    // 切换日期时，重置时间防止冲突\r\n    onDateChange() {\r\n      this.startTime = '';\r\n      this.endTime = '';\r\n      this.$nextTick(() => {\r\n        this.setDefaultStartTime();\r\n      });\r\n    },\r\n\r\n    setDefaultStartTime() {\r\n      if (this.type !== 'cross') return;\r\n      const earliest = this._earliestStartForDate(this.startDate);\r\n      this.startTime = earliest;\r\n      this.endTime = this._addMinutesToTimeStr(this.startTime, 30);\r\n    },\r\n\r\n    _addMinutesToTimeStr(timeStr, addMin) {\r\n      if (!timeStr) return timeStr;\r\n      const parts = timeStr.split(':');\r\n      const d = new Date();\r\n      d.setHours(parseInt(parts[0],10), parseInt(parts[1],10), 0, 0);\r\n      d.setMinutes(d.getMinutes() + addMin);\r\n      return ('0'+d.getHours()).slice(-2) + ':' + ('0'+d.getMinutes()).slice(-2);\r\n    },\r\n\r\n    _timeStrToMinutes(timeStr) {\r\n      const p = timeStr.split(':');\r\n      return parseInt(p[0],10)*60 + parseInt(p[1],10);\r\n    },\r\n\r\n    validateBeforeSubmit(startDateTime, endDateTime) {\r\n      const gran = 30;\r\n      const granMs = gran * 60 * 1000;\r\n\r\n      if (endDateTime <= startDateTime) {\r\n        this.$message.error('结束时间必须晚于开始时间');\r\n        return false;\r\n      }\r\n      if ((startDateTime.getSeconds() !== 0) || (startDateTime.getMilliseconds() !== 0) ||\r\n          (endDateTime.getSeconds() !== 0) || (endDateTime.getMilliseconds() !== 0)) {\r\n        this.$message.error('请把秒和毫秒设置为 0');\r\n        return false;\r\n      }\r\n      if (startDateTime.getMinutes() % gran !== 0 || endDateTime.getMinutes() % gran !== 0) {\r\n        this.$message.error('开始/结束时间必须为 30 分钟的倍数（例如 08:00 或 08:30）');\r\n        return false;\r\n      }\r\n      const now = new Date();\r\n      if (startDateTime.toISOString().slice(0, 10) === now.toISOString().slice(0, 10)) {\r\n        const roundedNowMs = Math.ceil(now.getTime() / granMs) * granMs;\r\n        if (startDateTime.getTime() < roundedNowMs) {\r\n          this.$message.error(`当天预约必须在当前时间之后（按30分钟取整），`);\r\n          return false;\r\n        }\r\n      }\r\n      if ((endDateTime.getTime() - startDateTime.getTime()) % granMs !== 0) {\r\n        this.$message.error('预约时长必须为 30 分钟的倍数');\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n\r\n    async onSubmit() {\r\n      this.$refs[\"ruleForm\"].validate(async valid => {\r\n        if (!valid) return;\r\n        if (this.type === 'cross') {\r\n          if (!this.startDate || !this.startTime || !this.endTime) {\r\n            this.$message.error('请先选择预约日期与时间');\r\n            return;\r\n          }\r\n          // ensure earliest computed fresh\r\n          this.refreshEarliestStart();\r\n\r\n          const startDt = new Date(`${this.startDate} ${this.startTime}:00`);\r\n          const endDt = new Date(`${this.startDate} ${this.endTime}:00`);\r\n          if (!this.validateBeforeSubmit(startDt, endDt)) return;\r\n\r\n          const crossObj = JSON.parse(localStorage.getItem('crossObj') || '{}');\r\n          const payload = {\r\n            zixishiid: crossObj.id || crossObj.zixishiId || null,\r\n            zuowei: parseInt(this.ruleForm.zuowei || crossObj.zuowei || 0, 10),\r\n            xuehao: this.sessionUser && (this.sessionUser.username || this.sessionUser.xuehao) ? (this.sessionUser.username || this.sessionUser.xuehao) : (localStorage.getItem('username') || ''),\r\n            xingming: this.sessionUser && (this.sessionUser.name || this.sessionUser.xingming) ? (this.sessionUser.name || this.sessionUser.xingming) : '',\r\n            shouji: this.sessionUser && (this.sessionUser.shouji || this.sessionUser.mobile) ? (this.sessionUser.shouji || this.sessionUser.mobile) : '',\r\n            yuyueStart: this._formatDate(startDt),\r\n            yuyueEnd: this._formatDate(endDt),\r\n            mingcheng: this.ruleForm.mingcheng || crossObj.mingcheng || ''\r\n          };\r\n\r\n          try {\r\n            const res = await this.$http.post('/yuyuexinxi/submit', payload);\r\n            if (res && res.data && res.data.code === 0) {\r\n              this.$message({ message: '预约成功', type: 'success', duration: 1500, onClose: ()=> { this.$router.go(-1); }});\r\n            } else {\r\n              this.$message.error(res && res.data && res.data.msg ? res.data.msg : '预约失败');\r\n            }\r\n          } catch (err) {\r\n            console.error('submit error', err);\r\n            this.$message.error('预约请求失败');\r\n          }\r\n          return;\r\n        }\r\n\r\n        // non-cross: create study room\r\n        try {\r\n          const res = await this.$http.post('zixishi/add', this.ruleForm);\r\n          if (res && res.data && res.data.code == 0) {\r\n            this.$message({ message: '操作成功', type: 'success', duration: 1500, onClose: () => { this.$router.go(-1); }});\r\n          } else {\r\n            this.$message.error(res && res.data && res.data.msg ? res.data.msg : '操作失败');\r\n          }\r\n        } catch (e) {\r\n          this.$message.error('请求失败');\r\n        }\r\n      });\r\n    },\r\n\r\n    _formatDate(d) {\r\n      const Y = d.getFullYear();\r\n      const M = ('0'+(d.getMonth()+1)).slice(-2);\r\n      const D = ('0'+d.getDate()).slice(-2);\r\n      const h = ('0'+d.getHours()).slice(-2);\r\n      const m = ('0'+d.getMinutes()).slice(-2);\r\n      const s = ('0'+d.getSeconds()).slice(-2);\r\n      return `${Y}-${M}-${D} ${h}:${m}:${s}`;\r\n    },\r\n\r\n    disabledAvailabilityDate(date) {\r\n      if (!date) return true;\r\n      const d = new Date(date);\r\n      const today = new Date();\r\n      today.setHours(0,0,0,0);\r\n      const max = new Date(today);\r\n      max.setDate(today.getDate() + 1);\r\n      max.setHours(23,59,59,999);\r\n      return d < today || d > max;\r\n    },\r\n\r\n    tupianUploadChange(fileUrls) {\r\n      this.ruleForm.tupian = fileUrls.replace(new RegExp(this.$config.baseUrl, \"g\"), \"\");\r\n    },\r\n\r\n    getUUID() { return new Date().getTime(); },\r\n    back() { this.$router.go(-1); }\r\n  }\r\n};\r\n</script>\r\n\r\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\r\n.el-date-editor.el-input { width: auto; }\r\n\r\n.add-update-preview .el-form-item >>> .el-form-item__label {\r\n  padding: 0 10px 0 0;\r\n  color: #666;\r\n  font-weight: 500;\r\n  width: 120px;\r\n  font-size: 14px;\r\n  line-height: 40px;\r\n  text-align: center;\r\n}\r\n\r\n.add-update-preview .el-form-item >>> .el-form-item__content { margin-left: 120px; }\r\n\r\n.add-update-preview .el-input >>> .el-input__inner {\r\n  border: 2px solid #2e61e1;\r\n  border-radius: 4px;\r\n  padding: 0 12px;\r\n  outline: none;\r\n  color: #000;\r\n  background: #BFD2FC;\r\n  width: 100%;\r\n  font-size: 14px;\r\n  height: 40px;\r\n}\r\n\r\n.add-update-preview .el-select >>> .el-input__inner {\r\n  border: 2px solid #2e61e1;\r\n  border-radius: 4px;\r\n  padding: 0 10px;\r\n  outline: none;\r\n  color: #000;\r\n  background: #BFD2FC;\r\n  width: 100%;\r\n  font-size: 14px;\r\n  height: 40px;\r\n}\r\n\r\n.add-update-preview .el-date-editor >>> .el-input__inner {\r\n  border: 2px solid #2e61e1;\r\n  border-radius: 4px;\r\n  padding: 0 10px 0 30px;\r\n  outline: none;\r\n  color: #000;\r\n  background: #BFD2FC;\r\n  width: 100%;\r\n  font-size: 14px;\r\n  height: 40px;\r\n}\r\n\r\n/* upload visuals */\r\n.add-update-preview >>> .upload .upload-img {\r\n  border: 1px dashed rgba(64, 158, 255, 1);\r\n  cursor: pointer;\r\n  border-radius: 6px;\r\n  width: 100px;\r\n  height: 100px;\r\n}\r\n\r\n/* textarea */\r\n.add-update-preview .el-textarea >>> .el-textarea__inner {\r\n  border: 2px solid #2e61e1;\r\n  border-radius: 4px;\r\n  padding: 12px;\r\n  outline: none;\r\n  color: #000;\r\n  background: #BFD2FC;\r\n  width: 100%;\r\n  font-size: 14px;\r\n  height: 120px;\r\n}\r\n\r\n/* 强制修改下拉组件的背景和边框，使其符合你的 UI */\r\n.add-update-preview .el-time-select >>> .el-input__inner {\r\n  border: 2px solid #2e61e1 !important;\r\n  background: #BFD2FC !important;\r\n  color: #000 !important;\r\n  width: 150px !important;\r\n}\r\n</style>"]}]}